{"ast":null,"code":"var _jsxFileName = \"/Users/hanguyen/Documents/git/routebuilder/src/components/SearchPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { FlightResults } from './FlightResults';\nimport UA_miles from '../data/UA_miles.json';\nimport SQ_miles from '../data/SQ_miles.json';\nimport LH_miles from '../data/LH_miles.json';\nimport LX_miles from '../data/LX_miles.json';\nimport TG_miles from '../data/TG_miles.json';\nimport BR_miles from '../data/BR_miles.json';\nimport NH_miles from '../data/NH_miles.json';\nimport OS_miles from '../data/OS_miles.json';\nimport OZ_miles from '../data/OZ_miles.json';\nimport NZ_miles from '../data/NZ_miles.json';\nimport SA_miles from '../data/SA_miles.json';\nimport AI_miles from '../data/AI_miles.json';\nimport LO_miles from '../data/LO_miles.json';\nimport SN_miles from '../data/SN_miles.json';\nimport A3_miles from '../data/A3_miles.json';\nimport TP_miles from '../data/TP_miles.json';\nimport MS_miles from '../data/MS_miles.json';\nimport WY_miles from '../data/WY_miles.json';\nimport GF_miles from '../data/GF_miles.json';\nimport AC_miles from '../data/AC_miles.json';\nimport { airports } from '../data/airports';\nimport { getUniqueCountries } from '../utils/countryUtils';\nimport Select from 'react-select';\nimport AsyncSelect from 'react-select/async';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst COTERMINALS = {\n  // North America\n  'CHI': ['MDW', 'ORD'],\n  'DAL': ['DFW', 'DAL'],\n  'HOU': ['IAH', 'HOU'],\n  'NYC': ['JFK', 'LGA', 'EWR'],\n  'SFL': ['FLL', 'MIA', 'PBI'],\n  'YTO': ['YTZ', 'YHM', 'YYZ'],\n  'WAS': ['IAD', 'DCA'],\n  // South America\n  'BUE': ['AEP', 'EZE'],\n  'RIO': ['GIG', 'SDU'],\n  'SAO': ['CGH', 'GRU', 'VCP'],\n  // Europe\n  'IST': ['IST', 'SAW'],\n  'LON': ['LCY', 'LGW', 'LHR', 'LTN', 'STN'],\n  'MIL': ['BGY', 'LIN', 'MXP'],\n  'MOW': ['DME', 'SVO', 'VNO', 'ZIA'],\n  'PAR': ['CDG', 'ORY'],\n  'STO': ['ARN', 'BMA'],\n  // Asia\n  'BJS': ['PEK', 'PKX'],\n  'JKT': ['CGK', 'HLP'],\n  'OSA': ['ITM', 'KIX', 'UKB'],\n  'SPK': ['CTS', 'OKD'],\n  'SEL': ['GMP', 'ICN'],\n  'SHA': ['SHA', 'PVG'],\n  'TPE': ['TSA', 'TPE'],\n  'TYO': ['HND', 'NRT']\n};\nfunction getCoTerminalGroup(airport) {\n  for (const [group, airports] of Object.entries(COTERMINALS)) {\n    if (airports.includes(airport)) {\n      return group;\n    }\n  }\n  return null;\n}\nfunction isValidCoTerminalRoute(newSegment, existingPath) {\n  const allAirports = [...existingPath.map(seg => seg.Departure_IATA), ...existingPath.map(seg => seg.Arrival_IATA), newSegment[\"Departure IATA\"], newSegment[\"Arrival IATA\"]];\n  const usedCoTerminals = new Map();\n  for (const airport of allAirports) {\n    const coTerminalGroup = getCoTerminalGroup(airport);\n    if (coTerminalGroup) {\n      if (usedCoTerminals.has(coTerminalGroup)) {\n        // If we already used a different airport from this co-terminal group\n        if (usedCoTerminals.get(coTerminalGroup) !== airport) {\n          return false;\n        }\n      } else {\n        usedCoTerminals.set(coTerminalGroup, airport);\n      }\n    }\n  }\n  return true;\n}\n\n// Constants for region restrictions\nconst EUROPEAN_COUNTRIES = new Set(['Germany', 'United Kingdom', 'France', 'Italy', 'Spain', 'Poland', 'Ukraine', 'Romania', 'Netherlands', 'Belgium', 'Czechia', 'Sweden', 'Portugal', 'Greece', 'Hungary', 'Austria', 'Belarus', 'Switzerland', 'Bulgaria', 'Serbia', 'Denmark', 'Finland', 'Norway', 'Slovakia', 'Ireland', 'Croatia', 'Bosnia And Herzegovina', 'Moldova', 'Lithuania', 'Albania', 'Slovenia', 'Latvia', 'North Macedonia', 'Estonia', 'Luxembourg', 'Montenegro', 'Malta', 'Iceland']);\n\n// First, let's create a helper function to check if a route avoids certain countries\nconst isRouteAvoidingCountries = (route, avoidCountries) => {\n  // Check each airport in the route\n  for (const segment of route) {\n    const departureAirport = airports.find(a => a.IATA === segment.Departure_IATA);\n    const arrivalAirport = airports.find(a => a.IATA === segment.Arrival_IATA);\n\n    // If any airport in the route is in an avoided country, return false\n    if (departureAirport && avoidCountries.includes(departureAirport.Country)) {\n      return false;\n    }\n    if (arrivalAirport && avoidCountries.includes(arrivalAirport.Country)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n// Create airlines list from your JSON imports\nconst airlines = [{\n  value: 'A3',\n  label: 'Aegean Airlines (A3)'\n}, {\n  value: 'AC',\n  label: 'Air Canada (AC)'\n}, {\n  value: 'AI',\n  label: 'Air India (AI)'\n}, {\n  value: 'NZ',\n  label: 'Air New Zealand (NZ)'\n}, {\n  value: 'NH',\n  label: 'All Nippon Airways (NH)'\n}, {\n  value: 'OZ',\n  label: 'Asiana Airlines (OZ)'\n}, {\n  value: 'OS',\n  label: 'Austrian Airlines (OS)'\n}, {\n  value: 'SN',\n  label: 'Brussels Airlines (SN)'\n}, {\n  value: 'MS',\n  label: 'EgyptAir (MS)'\n}, {\n  value: 'BR',\n  label: 'EVA Air (BR)'\n}, {\n  value: 'GF',\n  label: 'Gulf Air (GF)'\n}, {\n  value: 'LO',\n  label: 'LOT Polish Airlines (LO)'\n}, {\n  value: 'LH',\n  label: 'Lufthansa (LH)'\n}, {\n  value: 'WY',\n  label: 'Oman Air (WY)'\n}, {\n  value: 'SQ',\n  label: 'Singapore Airlines (SQ)'\n}, {\n  value: 'SA',\n  label: 'South African Airways (SA)'\n}, {\n  value: 'LX',\n  label: 'Swiss International Air Lines (LX)'\n}, {\n  value: 'TP',\n  label: 'TAP Air Portugal (TP)'\n}, {\n  value: 'TG',\n  label: 'Thai Airways (TG)'\n}, {\n  value: 'UA',\n  label: 'United Airlines (UA)'\n}].sort((a, b) => a.label.localeCompare(b.label));\n\n// Helper function to calculate distance between two points using Haversine formula\nconst calculateDistance = (lat1, lon1, lat2, lon2) => {\n  const R = 6371; // Earth's radius in kilometers\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLon = (lon2 - lon1) * Math.PI / 180;\n  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n};\n\n// Calculate total distance for a route\nconst calculateRouteDistance = route => {\n  let totalDistance = 0;\n  for (let i = 0; i < route.length; i++) {\n    const segment = route[i];\n    const departureAirport = airports.find(a => a.IATA === segment.Departure_IATA);\n    const arrivalAirport = airports.find(a => a.IATA === segment.Arrival_IATA);\n    if (departureAirport && arrivalAirport) {\n      const segmentDistance = calculateDistance(departureAirport.Latitude, departureAirport.Longitude, arrivalAirport.Latitude, arrivalAirport.Longitude);\n      totalDistance += segmentDistance;\n    }\n  }\n  return totalDistance;\n};\n\n// ===============================\n// Hub Airport Exceptions\n// ===============================\n\n// Airports exempt from standard layover restrictions\nconst HUB_EXCEPTIONS = new Set([\n// Star Alliance Hubs\n'ATH',\n// Aegean\n'PEK', 'CTU', 'PVG',\n// Air China\n'DEL', 'BOM',\n// Air India\n'AKL', 'WLG', 'CHC',\n// Air New Zealand\n'HND', 'NRT', 'KIX',\n// ANA\n'ICN', 'GMP',\n// Asiana\n'VIE',\n// Austrian\n'BOG', 'MDE', 'UIO', 'GUA', 'SAL',\n// Avianca\n'BRU',\n// Brussels\n'PTY',\n// Copa\n'ZAG',\n// Croatia\n'CAI',\n// EgyptAir\n'ADD',\n// Ethiopian\n'TPE',\n// EVA\n'WAW',\n// LOT\n'FRA', 'MUC',\n// Lufthansa\n'SZX',\n// Shenzhen\n'SIN',\n// Singapore\n'JNB',\n// South African\n'ZRH', 'GVA',\n// SWISS\n'LIS', 'OPO',\n// TAP\n'BKK',\n// Thai\n'IST',\n// Turkish\n'ORD', 'DEN', 'IAH', 'LAX', 'EWR', 'SFO', 'IAD',\n// United\n// Non-Alliance Hubs\n'YVO', 'YUL',\n// Air Creebec\n'MUC', 'FRA',\n// Air Dolomiti\n'MRU',\n// Air Mauritius\n'BEG',\n// Air Serbia\n'VCP', 'CNF', 'REC',\n// Azul\n'YWG', 'YTH',\n// Calm Air\n'YZF', 'YFB',\n// Canadian North\n'HKG',\n// Cathay Pacific\n'FRA',\n// Discover\n'ZRH',\n// Edelweiss\n'AUH',\n// Etihad\n'DUS', 'CGN', 'HAM', 'STR',\n// Eurowings\n'GRU', 'GIG', 'BSB',\n// GOL\n'BAH',\n// Gulf Air\n'PVG', 'SHA',\n// Juneyao\n'ATH',\n// Olympic\n'MCT',\n// Oman Air\n'YYT', 'YHZ',\n// PAL Airlines\n'AYT', 'ADB',\n// SunExpress\n'BNE', 'MEL', 'SYD' // Virgin Australia\n]);\nexport function SearchPage() {\n  _s();\n  var _airports$find5, _airports$find6, _airports$find7, _airports$find8, _airports$find9, _airports$find10;\n  // State for selected airports and search results\n  const [departureAirport, setDepartureAirport] = useState('');\n  const [arrivalAirport, setArrivalAirport] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [showResults, setShowResults] = useState(false);\n  const [avoidCountries, setAvoidCountries] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [avoidAirlines, setAvoidAirlines] = useState([]);\n  const [maxSegments, setMaxSegments] = useState(4); // Default to 4\n\n  // Get the country options when component mounts\n  const countryOptions = useMemo(() => {\n    return getUniqueCountries(airports);\n  }, []);\n\n  // Calculates direct distance between airports using Haversine formula\n  function calculateDirectDistance(origin, destination) {\n    const originAirport = airports.find(a => a.IATA === origin);\n    const destAirport = airports.find(a => a.IATA === destination);\n    if (!originAirport || !destAirport) return null;\n    const R = 3959; // Earth's radius in miles\n    const lat1 = originAirport.Latitude * Math.PI / 180;\n    const lat2 = destAirport.Latitude * Math.PI / 180;\n    const dLat = (destAirport.Latitude - originAirport.Latitude) * Math.PI / 180;\n    const dLon = (destAirport.Longitude - originAirport.Longitude) * Math.PI / 180;\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(lat1) * Math.cos(lat2) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  }\n\n  // Recursive function to find all valid routes between origin and destination\n  // Constraints:\n  // - Maximum 4 segments (3 stops)\n  // - Total distance <= 2x direct distance\n  // - No revisiting airports\n  // - No backtracking to previously visited countries (except direct connections)\n  // - Maximum 2 layovers in US/Canada unless both origin and destination are in US/Canada\n  const findPossibleRoutes = (origin, destination, visited = new Set(), visitedCountries = new Set(), path = [], directDistance = null) => {\n    // Create filtered allRoutes based on avoided airlines\n    const allRoutes = [...(avoidAirlines.includes('UA') ? [] : UA_miles), ...(avoidAirlines.includes('SQ') ? [] : SQ_miles), ...(avoidAirlines.includes('LH') ? [] : LH_miles), ...(avoidAirlines.includes('LX') ? [] : LX_miles), ...(avoidAirlines.includes('TG') ? [] : TG_miles), ...(avoidAirlines.includes('BR') ? [] : BR_miles), ...(avoidAirlines.includes('NH') ? [] : NH_miles), ...(avoidAirlines.includes('OS') ? [] : OS_miles), ...(avoidAirlines.includes('OZ') ? [] : OZ_miles), ...(avoidAirlines.includes('NZ') ? [] : NZ_miles), ...(avoidAirlines.includes('SA') ? [] : SA_miles), ...(avoidAirlines.includes('AI') ? [] : AI_miles), ...(avoidAirlines.includes('LO') ? [] : LO_miles), ...(avoidAirlines.includes('SN') ? [] : SN_miles), ...(avoidAirlines.includes('A3') ? [] : A3_miles), ...(avoidAirlines.includes('TP') ? [] : TP_miles), ...(avoidAirlines.includes('MS') ? [] : MS_miles), ...(avoidAirlines.includes('WY') ? [] : WY_miles), ...(avoidAirlines.includes('GF') ? [] : GF_miles), ...(avoidAirlines.includes('AC') ? [] : AC_miles)];\n    const routes = [];\n\n    // Get origin and destination airport details for US/Canada check\n    const originAirport = airports.find(a => a.IATA === origin);\n    const destAirport = airports.find(a => a.IATA === destination);\n    const isOriginNorthAmerica = ['United States', 'Canada'].includes(originAirport === null || originAirport === void 0 ? void 0 : originAirport.Country);\n    const isDestNorthAmerica = ['United States', 'Canada'].includes(destAirport === null || destAirport === void 0 ? void 0 : destAirport.Country);\n    const bothInNorthAmerica = isOriginNorthAmerica && isDestNorthAmerica;\n\n    // Count existing North American layovers, treating non-hubs and hubs separately\n    const northAmericaLayovers = path.reduce((count, segment) => {\n      const layoverAirport = airports.find(a => a.IATA === segment.Arrival_IATA);\n      if (!layoverAirport || !['United States', 'Canada'].includes(layoverAirport.Country)) {\n        return count;\n      }\n      if (HUB_EXCEPTIONS.has(segment.Arrival_IATA)) {\n        return {\n          ...count,\n          hubCount: 1\n        }; // All hubs count as 1 total\n      }\n      return {\n        ...count,\n        nonHubCount: count.nonHubCount + 1\n      }; // Each non-hub counts as 1\n    }, {\n      nonHubCount: 0,\n      hubCount: 0\n    });\n\n    // Count existing European layovers in the current path\n    const europeanLayovers = path.reduce((count, segment) => {\n      const layoverAirport = airports.find(a => a.IATA === segment.Arrival_IATA);\n      if (!layoverAirport || !EUROPEAN_COUNTRIES.has(layoverAirport.Country)) {\n        return count;\n      }\n\n      // If it's a hub airport, we've already counted hubs, don't increment\n      if (HUB_EXCEPTIONS.has(segment.Arrival_IATA)) {\n        return count + (count.hasHub ? 0 : 1); // Only count hubs once total\n      }\n\n      // Non-hub European airports count as 1 each\n      return count + 1;\n    }, {\n      total: 0,\n      hasHub: false\n    });\n\n    // Calculate direct distance if not provided\n    if (directDistance === null) {\n      directDistance = calculateDirectDistance(origin, destination);\n      if (!directDistance) return [];\n    }\n\n    // Base case: if we've found a path to the destination\n    if (path.length > 0 && path[path.length - 1].Arrival_IATA === destination) {\n      const totalDistance = path.reduce((sum, segment) => sum + segment.Distance, 0);\n      if (totalDistance <= directDistance * 2) {\n        return [path];\n      }\n      return [];\n    }\n\n    // Don't allow paths longer than 6 segments (5 stops)\n    if (path.length >= maxSegments) {\n      return [];\n    }\n\n    // Get current point and its country\n    const currentPoint = path.length === 0 ? origin : path[path.length - 1].Arrival_IATA;\n    const currentAirport = airports.find(a => a.IATA === currentPoint);\n    if (!currentAirport) return [];\n\n    // Add helper function to count layovers by country\n    const getLayoverCountByCountry = currentPath => {\n      const countByCountry = {};\n      currentPath.forEach(segment => {\n        const airport = airports.find(a => a.IATA === segment.Arrival_IATA);\n        if (!airport) return;\n        const country = airport.Country;\n        if (!countByCountry[country]) {\n          countByCountry[country] = {\n            nonHubCount: 0,\n            hasHub: false\n          };\n        }\n        if (HUB_EXCEPTIONS.has(segment.Arrival_IATA)) {\n          countByCountry[country].hasHub = true;\n        } else {\n          countByCountry[country].nonHubCount += 1;\n        }\n      });\n      return countByCountry;\n    };\n    const possibleSegments = allRoutes.filter(route => {\n      var _airports$find, _airports$find2;\n      if (route[\"Departure IATA\"] !== currentPoint) return false;\n\n      // Get origin and destination countries\n      const originAirport = airports.find(a => a.IATA === origin);\n      const destAirport = airports.find(a => a.IATA === destination);\n      const thisArrivalAirport = airports.find(a => a.IATA === route[\"Arrival IATA\"]);\n      if (!originAirport || !destAirport || !thisArrivalAirport) return false;\n\n      // Check for multiple layovers in same country\n      const countryLayovers = getLayoverCountByCountry(path);\n      const nextCountry = thisArrivalAirport.Country;\n\n      // Allow multiple stops only if it's origin or destination country\n      if (nextCountry !== originAirport.Country && nextCountry !== destAirport.Country && countryLayovers[nextCountry] >= 1 && !HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) {\n        return false;\n      }\n\n      // Get zones\n      const originZone = (_airports$find = airports.find(a => a.IATA === origin)) === null || _airports$find === void 0 ? void 0 : _airports$find.Zone;\n      const destZone = (_airports$find2 = airports.find(a => a.IATA === destination)) === null || _airports$find2 === void 0 ? void 0 : _airports$find2.Zone;\n      const connectZone = thisArrivalAirport === null || thisArrivalAirport === void 0 ? void 0 : thisArrivalAirport.Zone;\n\n      // Rule: When flying between two zones, cannot connect via a third zone\n      // Example: North America to Atlantic cannot connect via Pacific\n      if (originZone !== destZone &&\n      // Different zones\n      connectZone !== originZone &&\n      // Not in origin zone\n      connectZone !== destZone) {\n        // Not in destination zone\n        return false;\n      }\n\n      // Add co-terminal validation\n      if (!isValidCoTerminalRoute(route, path)) {\n        return false;\n      }\n\n      // Get the arrival airport details\n      const arrivalAirport = airports.find(a => a.IATA === route[\"Arrival IATA\"]);\n      if (!arrivalAirport) return false;\n\n      // Check if adding this segment would exceed US/Canada layover limit\n      const isArrivalNorthAmerica = ['United States', 'Canada'].includes(arrivalAirport.Country);\n      if (isArrivalNorthAmerica && !bothInNorthAmerica) {\n        let nextNonHubCount = northAmericaLayovers.nonHubCount;\n        let nextHubCount = northAmericaLayovers.hubCount;\n        if (HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) {\n          nextHubCount = 1;\n        } else {\n          nextNonHubCount += 1;\n        }\n\n        // Total layovers = non-hub count + hub count (all hubs count as 1)\n        if (nextNonHubCount + nextHubCount > 2) {\n          return false;\n        }\n      }\n\n      // Check if adding this segment would exceed European layover limit\n      const isEuropeanArrival = EUROPEAN_COUNTRIES.has(arrivalAirport.Country);\n      const isEuropeanHub = HUB_EXCEPTIONS.has(route[\"Arrival IATA\"]);\n      if (isEuropeanArrival) {\n        let newLayoverCount = europeanLayovers;\n        if (isEuropeanHub && !europeanLayovers.hasHub) {\n          newLayoverCount += 1; // First hub encounter counts as 1\n        } else if (!isEuropeanHub) {\n          newLayoverCount += 1; // Non-hub counts as 1\n        }\n        if (newLayoverCount > 2) {\n          return false;\n        }\n      }\n\n      // Check if we're not backtracking to a visited airport\n      if (visited.has(route[\"Arrival IATA\"])) return false;\n\n      // Check if we're not backtracking to a visited country\n      // Exception: Allow same country connection if it's a direct continuation\n      const isBacktrackingCountry = visitedCountries.has(arrivalAirport.Country) && arrivalAirport.Country !== currentAirport.Country;\n      if (isBacktrackingCountry) return false;\n\n      // Rule: Maximum 1 layover per transit country (with hub exceptions)\n      const layoverCounts = getLayoverCountByCountry(path);\n      const arrivalCountry = arrivalAirport.Country;\n      if (arrivalCountry !== originAirport.Country && arrivalCountry !== destAirport.Country && layoverCounts[arrivalCountry] >= 1 && !HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) {\n        // Add exception check\n        return false;\n      }\n\n      // Rule: Maximum 2 stops in Europe (with hub exceptions)\n      if (isEuropeanArrival && europeanLayovers >= 2 && !HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) {\n        // Add exception check\n        return false;\n      }\n\n      // Check if adding this stop would exceed country limit\n      if (nextCountry !== originAirport.Country && nextCountry !== destAirport.Country) {\n        const currentCount = countryLayovers[nextCountry] || {\n          nonHubCount: 0,\n          hasHub: false\n        };\n        let totalStops = currentCount.nonHubCount;\n        if (currentCount.hasHub || HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) {\n          totalStops += 1; // All hubs in country count as 1 total\n        }\n        if (totalStops >= 2) {\n          return false;\n        }\n      }\n      return true;\n    });\n\n    // Try each possible next segment\n    for (const segment of possibleSegments) {\n      const arrivalAirport = airports.find(a => a.IATA === segment[\"Arrival IATA\"]);\n\n      // Calculate running total distance\n      const currentTotalDistance = path.reduce((sum, seg) => sum + seg.Distance, 0) + segment[\"Flight Distance (miles)\"];\n\n      // Skip this path if it's already over 2x direct distance\n      if (currentTotalDistance > directDistance * 2) {\n        continue;\n      }\n\n      // Update visited sets\n      const newVisited = new Set(visited);\n      newVisited.add(segment[\"Arrival IATA\"]);\n      const newVisitedCountries = new Set(visitedCountries);\n      newVisitedCountries.add(arrivalAirport.Country);\n      const newPath = [...path, {\n        Departure_IATA: segment[\"Departure IATA\"],\n        Arrival_IATA: segment[\"Arrival IATA\"],\n        Distance: segment[\"Flight Distance (miles)\"],\n        Country: arrivalAirport.Country // Add country info for reference\n      }];\n      const newRoutes = findPossibleRoutes(origin, destination, newVisited, newVisitedCountries, newPath, directDistance);\n      routes.push(...newRoutes);\n    }\n    return routes;\n  };\n\n  // Handles the search button click\n  // Updates URL parameters and finds possible routes\n  const handleSearch = async () => {\n    // Show loading overlay immediately\n    setIsLoading(true);\n    setShowResults(false);\n    try {\n      // Wait for 250ms to ensure overlay is visible\n      await new Promise(resolve => setTimeout(resolve, 250));\n      if (departureAirport && arrivalAirport) {\n        const params = new URLSearchParams();\n        params.set('from', departureAirport);\n        params.set('to', arrivalAirport);\n        params.set('avoidCountries', avoidCountries.join(','));\n        window.history.pushState({}, '', `${window.location.pathname}?${params.toString()}`);\n        const originAirport = airports.find(a => a.IATA === departureAirport);\n        const visited = new Set([departureAirport]);\n        const visitedCountries = new Set([originAirport.Country]);\n        const routes = findPossibleRoutes(departureAirport, arrivalAirport, visited, visitedCountries);\n\n        // Filter out routes that go through avoided countries\n        const filteredRoutes = routes.filter(route => isRouteAvoidingCountries(route, avoidCountries));\n\n        // Sort routes by total distance\n        const sortedRoutes = filteredRoutes.sort((a, b) => {\n          const distanceA = calculateRouteDistance(a);\n          const distanceB = calculateRouteDistance(b);\n          return distanceA - distanceB; // Low to high\n        });\n        setSearchResults(sortedRoutes);\n        setShowResults(true);\n      }\n    } catch (error) {\n      console.error('Error searching routes:', error);\n    } finally {\n      // Add a small delay before hiding loading screen for smoother transition\n      await new Promise(resolve => setTimeout(resolve, 100));\n      setIsLoading(false);\n    }\n  };\n\n  // Airport search with better IATA and name prioritization\n  const getAirportOptions = inputValue => {\n    if (!inputValue) return [];\n    const input = inputValue.toLowerCase().trim();\n\n    // Priority 1: Exact IATA match\n    const exactIataMatches = airports.filter(airport => airport.IATA.toLowerCase() === input);\n\n    // Priority 2: IATA starts with input\n    const startingIataMatches = airports.filter(airport => airport.IATA.toLowerCase().startsWith(input) && !exactIataMatches.includes(airport));\n\n    // Priority 3: Airport name starts with input\n    const startingNameMatches = airports.filter(airport => airport.Name.toLowerCase().startsWith(input) && !exactIataMatches.includes(airport) && !startingIataMatches.includes(airport));\n\n    // Priority 4: Airport name contains input\n    const containingNameMatches = airports.filter(airport => airport.Name.toLowerCase().includes(input) && !exactIataMatches.includes(airport) && !startingIataMatches.includes(airport) && !startingNameMatches.includes(airport));\n\n    // Combine all matches with proper ordering\n    const allMatches = [...exactIataMatches, ...startingIataMatches, ...startingNameMatches, ...containingNameMatches].slice(0, 5); // Limit to 5 results\n\n    return allMatches.map(airport => ({\n      value: airport.IATA,\n      label: `${airport.IATA} - ${airport.Name} (${airport.Country})`\n    }));\n  };\n\n  // Country search with progressive character matching\n  const getCountryOptions = inputValue => {\n    if (!inputValue) return [];\n    const input = inputValue.toLowerCase().trim();\n    const countries = getUniqueCountries(airports);\n\n    // First: Exact matches\n    const exactMatches = countries.filter(country => country.toLowerCase() === input);\n\n    // Second: Starting matches (progressive matching)\n    const startingMatches = countries.filter(country => country.toLowerCase().startsWith(input) && !exactMatches.includes(country));\n\n    // Third: Progressive character matching\n    const progressiveMatches = countries.filter(country => {\n      if (exactMatches.includes(country) || startingMatches.includes(country)) {\n        return false;\n      }\n      const countryChars = country.toLowerCase();\n      let lastIndex = -1;\n\n      // Check if characters appear in sequence\n      for (const char of input) {\n        const index = countryChars.indexOf(char, lastIndex + 1);\n        if (index === -1) return false;\n        lastIndex = index;\n      }\n      return true;\n    });\n\n    // Combine all matches with proper ordering\n    const allMatches = [...exactMatches, ...startingMatches, ...progressiveMatches].slice(0, 5); // Limit to 5 results\n\n    return allMatches.map(country => ({\n      value: country,\n      label: country\n    }));\n  };\n  const filterCountries = inputValue => {\n    if (!inputValue) return [];\n    const input = inputValue.toLowerCase().trim();\n    const countries = getUniqueCountries(airports);\n\n    // Priority 1: Exact matches\n    const exactMatches = countries.filter(country => country.toLowerCase() === input);\n\n    // Priority 2: Starts with input\n    const startingMatches = countries.filter(country => country.toLowerCase().startsWith(input) && !exactMatches.includes(country));\n\n    // Priority 3: Contains input\n    const containingMatches = countries.filter(country => country.toLowerCase().includes(input) && !exactMatches.includes(country) && !startingMatches.includes(country));\n    return [...exactMatches, ...startingMatches, ...containingMatches].slice(0, 5).map(country => ({\n      value: country,\n      label: country\n    }));\n  };\n  const loadCountryOptions = inputValue => new Promise(resolve => {\n    resolve(filterCountries(inputValue));\n  });\n  const filterAirports = inputValue => {\n    if (!inputValue) return [];\n    const input = inputValue.toLowerCase().trim();\n\n    // Filter out airports from avoided countries first\n    const availableAirports = airports.filter(airport => !avoidCountries.includes(airport.Country));\n\n    // Priority 1: Exact IATA match\n    const exactIataMatches = availableAirports.filter(airport => airport.IATA.toLowerCase() === input);\n\n    // Priority 2: IATA starts with input\n    const startingIataMatches = availableAirports.filter(airport => airport.IATA.toLowerCase().startsWith(input) && !exactIataMatches.includes(airport));\n\n    // Priority 3: Airport name starts with input\n    const startingNameMatches = availableAirports.filter(airport => airport.Name.toLowerCase().startsWith(input) && !exactIataMatches.includes(airport) && !startingIataMatches.includes(airport));\n\n    // Priority 4: Airport name contains input\n    const containingNameMatches = availableAirports.filter(airport => airport.Name.toLowerCase().includes(input) && !exactIataMatches.includes(airport) && !startingIataMatches.includes(airport) && !startingNameMatches.includes(airport));\n\n    // Combine all matches with proper ordering\n    const allMatches = [...exactIataMatches, ...startingIataMatches, ...startingNameMatches, ...containingNameMatches].slice(0, 5); // Limit to 5 results\n\n    return allMatches.map(airport => ({\n      value: airport.IATA,\n      label: `${airport.IATA} - ${airport.Name} (${airport.Country})`\n    }));\n  };\n  const loadAirportOptions = inputValue => new Promise(resolve => {\n    resolve(filterAirports(inputValue));\n  });\n\n  // Filter airlines function\n  const filterAirlines = inputValue => {\n    if (!inputValue) return airlines;\n    const input = inputValue.toLowerCase().trim();\n\n    // Priority 1: Exact airline code match\n    const exactCodeMatches = airlines.filter(airline => airline.value.toLowerCase() === input);\n\n    // Priority 2: Starting airline code match\n    const startingCodeMatches = airlines.filter(airline => airline.value.toLowerCase().startsWith(input) && !exactCodeMatches.includes(airline));\n\n    // Priority 3: Airline name contains input\n    const nameMatches = airlines.filter(airline => airline.label.toLowerCase().includes(input) && !exactCodeMatches.includes(airline) && !startingCodeMatches.includes(airline));\n    return [...exactCodeMatches, ...startingCodeMatches, ...nameMatches];\n  };\n  const loadAirlineOptions = inputValue => new Promise(resolve => {\n    resolve(filterAirlines(inputValue));\n  });\n\n  // Also clear selected airports if their country is now avoided\n  useEffect(() => {\n    if (departureAirport) {\n      var _airports$find3;\n      const departureCountry = (_airports$find3 = airports.find(a => a.IATA === departureAirport)) === null || _airports$find3 === void 0 ? void 0 : _airports$find3.Country;\n      if (departureCountry && avoidCountries.includes(departureCountry)) {\n        setDepartureAirport('');\n      }\n    }\n    if (arrivalAirport) {\n      var _airports$find4;\n      const arrivalCountry = (_airports$find4 = airports.find(a => a.IATA === arrivalAirport)) === null || _airports$find4 === void 0 ? void 0 : _airports$find4.Country;\n      if (arrivalCountry && avoidCountries.includes(arrivalCountry)) {\n        setArrivalAirport('');\n      }\n    }\n  }, [avoidCountries, departureAirport, arrivalAirport]);\n\n  // Update URL when form changes\n  useEffect(() => {\n    const params = new URLSearchParams();\n    if (departureAirport) params.set('from', departureAirport);\n    if (arrivalAirport) params.set('to', arrivalAirport);\n    if (avoidCountries.length > 0) params.set('avoid', avoidCountries.join(','));\n    if (maxSegments !== 4) params.set('max', maxSegments.toString()); // Only add if not default\n\n    const newUrl = `${window.location.pathname}${params.toString() ? '?' + params.toString() : ''}`;\n    window.history.replaceState({}, '', newUrl);\n  }, [departureAirport, arrivalAirport, avoidCountries, maxSegments]);\n\n  // Read URL params on initial load\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const originParam = params.get('from');\n    const destParam = params.get('to');\n    const avoidParam = params.get('avoid');\n    const maxParam = params.get('max');\n    if (originParam) setDepartureAirport(originParam);\n    if (destParam) setArrivalAirport(destParam);\n    if (avoidParam) setAvoidCountries(avoidParam.split(','));\n    if (maxParam) {\n      const maxValue = parseInt(maxParam, 10);\n      if (!isNaN(maxValue) && maxValue >= 0 && maxValue <= 6) {\n        setMaxSegments(maxValue);\n      }\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"search-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"search-boxes\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"airport-search\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-parameter departure-parameter\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              fontWeight: 700\n            },\n            children: \"Departure Airport:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 886,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(AsyncSelect, {\n            className: \"select-input\",\n            cacheOptions: true,\n            defaultOptions: true,\n            value: departureAirport ? {\n              value: departureAirport,\n              label: ((_airports$find5 = airports.find(a => a.IATA === departureAirport)) === null || _airports$find5 === void 0 ? void 0 : _airports$find5.IATA) + \" - \" + ((_airports$find6 = airports.find(a => a.IATA === departureAirport)) === null || _airports$find6 === void 0 ? void 0 : _airports$find6.Name) + \" (\" + ((_airports$find7 = airports.find(a => a.IATA === departureAirport)) === null || _airports$find7 === void 0 ? void 0 : _airports$find7.Country) + \")\"\n            } : null,\n            loadOptions: loadAirportOptions,\n            onChange: selected => setDepartureAirport(selected ? selected.value : ''),\n            isDisabled: isLoading,\n            placeholder: \"Select airports...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 887,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 885,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-parameter arrival-parameter\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              fontWeight: 700\n            },\n            children: \"Arrival Airport:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 904,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(AsyncSelect, {\n            className: \"select-input\",\n            cacheOptions: true,\n            defaultOptions: true,\n            value: arrivalAirport ? {\n              value: arrivalAirport,\n              label: ((_airports$find8 = airports.find(a => a.IATA === arrivalAirport)) === null || _airports$find8 === void 0 ? void 0 : _airports$find8.IATA) + \" - \" + ((_airports$find9 = airports.find(a => a.IATA === arrivalAirport)) === null || _airports$find9 === void 0 ? void 0 : _airports$find9.Name) + \" (\" + ((_airports$find10 = airports.find(a => a.IATA === arrivalAirport)) === null || _airports$find10 === void 0 ? void 0 : _airports$find10.Country) + \")\"\n            } : null,\n            loadOptions: loadAirportOptions,\n            onChange: selected => setArrivalAirport(selected ? selected.value : ''),\n            isDisabled: isLoading,\n            placeholder: \"Select airports...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 905,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 903,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 884,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"search-parameter\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Avoid Countries:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 923,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(AsyncSelect, {\n          isMulti: true,\n          className: \"select-input avoid-countries-select\",\n          cacheOptions: true,\n          defaultOptions: true,\n          value: avoidCountries.map(country => ({\n            value: country,\n            label: country\n          })),\n          loadOptions: loadCountryOptions,\n          onChange: selected => {\n            setAvoidCountries(selected ? selected.map(option => option.value) : []);\n          },\n          isDisabled: isLoading,\n          placeholder: \"Select countries...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 924,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 922,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"search-parameter\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Avoid Airlines:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 942,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(AsyncSelect, {\n          isMulti: true,\n          className: \"select-input avoid-airlines-select\",\n          cacheOptions: true,\n          defaultOptions: airlines,\n          value: avoidAirlines.map(airline => {\n            var _airlines$find;\n            return {\n              value: airline,\n              label: ((_airlines$find = airlines.find(a => a.value === airline)) === null || _airlines$find === void 0 ? void 0 : _airlines$find.label) || airline\n            };\n          }),\n          loadOptions: loadAirlineOptions,\n          onChange: selected => {\n            setAvoidAirlines(selected ? selected.map(option => option.value) : []);\n          },\n          isDisabled: isLoading,\n          placeholder: \"Select airlines to avoid...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 943,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 941,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"search-parameter max-segments-parameter\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Maximum Segments\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 961,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          min: \"0\",\n          max: \"6\",\n          value: maxSegments,\n          onChange: e => {\n            const value = parseInt(e.target.value, 10);\n            if (!isNaN(value) && value >= 0 && value <= 6) {\n              setMaxSegments(value);\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 962,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 960,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"search-button\",\n        onClick: handleSearch,\n        disabled: isLoading || !departureAirport || !arrivalAirport,\n        children: isLoading ? 'Searching...' : 'Search'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 975,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 883,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FlightResults, {\n      results: searchResults,\n      isVisible: showResults\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 983,\n      columnNumber: 7\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading-overlay\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 990,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-text\",\n        children: \"Searching for routes...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 991,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 989,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 882,\n    columnNumber: 5\n  }, this);\n}\n_s(SearchPage, \"ryalYuBxUb5tCLBV2fscj4Tgf6I=\");\n_c = SearchPage;\nvar _c;\n$RefreshReg$(_c, \"SearchPage\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","FlightResults","UA_miles","SQ_miles","LH_miles","LX_miles","TG_miles","BR_miles","NH_miles","OS_miles","OZ_miles","NZ_miles","SA_miles","AI_miles","LO_miles","SN_miles","A3_miles","TP_miles","MS_miles","WY_miles","GF_miles","AC_miles","airports","getUniqueCountries","Select","AsyncSelect","jsxDEV","_jsxDEV","COTERMINALS","getCoTerminalGroup","airport","group","Object","entries","includes","isValidCoTerminalRoute","newSegment","existingPath","allAirports","map","seg","Departure_IATA","Arrival_IATA","usedCoTerminals","Map","coTerminalGroup","has","get","set","EUROPEAN_COUNTRIES","Set","isRouteAvoidingCountries","route","avoidCountries","segment","departureAirport","find","a","IATA","arrivalAirport","Country","airlines","value","label","sort","b","localeCompare","calculateDistance","lat1","lon1","lat2","lon2","R","dLat","Math","PI","dLon","sin","cos","c","atan2","sqrt","calculateRouteDistance","totalDistance","i","length","segmentDistance","Latitude","Longitude","HUB_EXCEPTIONS","SearchPage","_s","_airports$find5","_airports$find6","_airports$find7","_airports$find8","_airports$find9","_airports$find10","setDepartureAirport","setArrivalAirport","searchResults","setSearchResults","showResults","setShowResults","setAvoidCountries","isLoading","setIsLoading","avoidAirlines","setAvoidAirlines","maxSegments","setMaxSegments","countryOptions","calculateDirectDistance","origin","destination","originAirport","destAirport","findPossibleRoutes","visited","visitedCountries","path","directDistance","allRoutes","routes","isOriginNorthAmerica","isDestNorthAmerica","bothInNorthAmerica","northAmericaLayovers","reduce","count","layoverAirport","hubCount","nonHubCount","europeanLayovers","hasHub","total","sum","Distance","currentPoint","currentAirport","getLayoverCountByCountry","currentPath","countByCountry","forEach","country","possibleSegments","filter","_airports$find","_airports$find2","thisArrivalAirport","countryLayovers","nextCountry","originZone","Zone","destZone","connectZone","isArrivalNorthAmerica","nextNonHubCount","nextHubCount","isEuropeanArrival","isEuropeanHub","newLayoverCount","isBacktrackingCountry","layoverCounts","arrivalCountry","currentCount","totalStops","currentTotalDistance","newVisited","add","newVisitedCountries","newPath","newRoutes","push","handleSearch","Promise","resolve","setTimeout","params","URLSearchParams","join","window","history","pushState","location","pathname","toString","filteredRoutes","sortedRoutes","distanceA","distanceB","error","console","getAirportOptions","inputValue","input","toLowerCase","trim","exactIataMatches","startingIataMatches","startsWith","startingNameMatches","Name","containingNameMatches","allMatches","slice","getCountryOptions","countries","exactMatches","startingMatches","progressiveMatches","countryChars","lastIndex","char","index","indexOf","filterCountries","containingMatches","loadCountryOptions","filterAirports","availableAirports","loadAirportOptions","filterAirlines","exactCodeMatches","airline","startingCodeMatches","nameMatches","loadAirlineOptions","_airports$find3","departureCountry","_airports$find4","newUrl","replaceState","search","originParam","destParam","avoidParam","maxParam","split","maxValue","parseInt","isNaN","className","children","style","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","cacheOptions","defaultOptions","loadOptions","onChange","selected","isDisabled","placeholder","isMulti","option","_airlines$find","type","min","max","e","target","onClick","disabled","results","isVisible","_c","$RefreshReg$"],"sources":["/Users/hanguyen/Documents/git/routebuilder/src/components/SearchPage.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport { FlightResults } from './FlightResults';\nimport UA_miles from '../data/UA_miles.json';\nimport SQ_miles from '../data/SQ_miles.json';\nimport LH_miles from '../data/LH_miles.json';\nimport LX_miles from '../data/LX_miles.json';\nimport TG_miles from '../data/TG_miles.json';\nimport BR_miles from '../data/BR_miles.json';\nimport NH_miles from '../data/NH_miles.json';\nimport OS_miles from '../data/OS_miles.json';\nimport OZ_miles from '../data/OZ_miles.json';\nimport NZ_miles from '../data/NZ_miles.json';   \nimport SA_miles from '../data/SA_miles.json';\nimport AI_miles from '../data/AI_miles.json';\nimport LO_miles from '../data/LO_miles.json';\nimport SN_miles from '../data/SN_miles.json'; \nimport A3_miles from '../data/A3_miles.json';\nimport TP_miles from '../data/TP_miles.json';\nimport MS_miles from '../data/MS_miles.json';\nimport WY_miles from '../data/WY_miles.json';\nimport GF_miles from '../data/GF_miles.json';\nimport AC_miles from '../data/AC_miles.json';\nimport { airports } from '../data/airports';\nimport { getUniqueCountries } from '../utils/countryUtils';\nimport Select from 'react-select';\nimport AsyncSelect from 'react-select/async';\n\nconst COTERMINALS = {\n  // North America\n  'CHI': ['MDW', 'ORD'],\n  'DAL': ['DFW', 'DAL'],\n  'HOU': ['IAH', 'HOU'],\n  'NYC': ['JFK', 'LGA', 'EWR'],\n  'SFL': ['FLL', 'MIA', 'PBI'],\n  'YTO': ['YTZ', 'YHM', 'YYZ'],\n  'WAS': ['IAD', 'DCA'],\n  \n  // South America\n  'BUE': ['AEP', 'EZE'],\n  'RIO': ['GIG', 'SDU'],\n  'SAO': ['CGH', 'GRU', 'VCP'],\n  \n  // Europe\n  'IST': ['IST', 'SAW'],\n  'LON': ['LCY', 'LGW', 'LHR', 'LTN', 'STN'],\n  'MIL': ['BGY', 'LIN', 'MXP'],\n  'MOW': ['DME', 'SVO', 'VNO', 'ZIA'],\n  'PAR': ['CDG', 'ORY'],\n  'STO': ['ARN', 'BMA'],\n  \n  // Asia\n  'BJS': ['PEK', 'PKX'],\n  'JKT': ['CGK', 'HLP'],\n  'OSA': ['ITM', 'KIX', 'UKB'],\n  'SPK': ['CTS', 'OKD'],\n  'SEL': ['GMP', 'ICN'],\n  'SHA': ['SHA', 'PVG'],\n  'TPE': ['TSA', 'TPE'],\n  'TYO': ['HND', 'NRT']\n};\n\nfunction getCoTerminalGroup(airport) {\n  for (const [group, airports] of Object.entries(COTERMINALS)) {\n    if (airports.includes(airport)) {\n      return group;\n    }\n  }\n  return null;\n}\n\nfunction isValidCoTerminalRoute(newSegment, existingPath) {\n  const allAirports = [\n    ...existingPath.map(seg => seg.Departure_IATA),\n    ...existingPath.map(seg => seg.Arrival_IATA),\n    newSegment[\"Departure IATA\"],\n    newSegment[\"Arrival IATA\"]\n  ];\n  \n  const usedCoTerminals = new Map();\n  \n  for (const airport of allAirports) {\n    const coTerminalGroup = getCoTerminalGroup(airport);\n    if (coTerminalGroup) {\n      if (usedCoTerminals.has(coTerminalGroup)) {\n        // If we already used a different airport from this co-terminal group\n        if (usedCoTerminals.get(coTerminalGroup) !== airport) {\n          return false;\n        }\n      } else {\n        usedCoTerminals.set(coTerminalGroup, airport);\n      }\n    }\n  }\n  \n  return true;\n}\n\n// Constants for region restrictions\nconst EUROPEAN_COUNTRIES = new Set([\n  'Germany', 'United Kingdom', 'France', 'Italy', 'Spain', 'Poland', 'Ukraine', \n  'Romania', 'Netherlands', 'Belgium', 'Czechia', 'Sweden', 'Portugal', 'Greece',\n  'Hungary', 'Austria', 'Belarus', 'Switzerland', 'Bulgaria', 'Serbia', 'Denmark',\n  'Finland', 'Norway', 'Slovakia', 'Ireland', 'Croatia', 'Bosnia And Herzegovina',\n  'Moldova', 'Lithuania', 'Albania', 'Slovenia', 'Latvia', 'North Macedonia',\n  'Estonia', 'Luxembourg', 'Montenegro', 'Malta', 'Iceland'\n]);\n\n// First, let's create a helper function to check if a route avoids certain countries\nconst isRouteAvoidingCountries = (route, avoidCountries) => {\n  // Check each airport in the route\n  for (const segment of route) {\n    const departureAirport = airports.find(a => a.IATA === segment.Departure_IATA);\n    const arrivalAirport = airports.find(a => a.IATA === segment.Arrival_IATA);\n    \n    // If any airport in the route is in an avoided country, return false\n    if (departureAirport && avoidCountries.includes(departureAirport.Country)) {\n      return false;\n    }\n    if (arrivalAirport && avoidCountries.includes(arrivalAirport.Country)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n// Create airlines list from your JSON imports\nconst airlines = [\n  { value: 'A3', label: 'Aegean Airlines (A3)' },\n  { value: 'AC', label: 'Air Canada (AC)' },\n  { value: 'AI', label: 'Air India (AI)' },\n  { value: 'NZ', label: 'Air New Zealand (NZ)' },\n  { value: 'NH', label: 'All Nippon Airways (NH)' },\n  { value: 'OZ', label: 'Asiana Airlines (OZ)' },\n  { value: 'OS', label: 'Austrian Airlines (OS)' },\n  { value: 'SN', label: 'Brussels Airlines (SN)' },\n  { value: 'MS', label: 'EgyptAir (MS)' },\n  { value: 'BR', label: 'EVA Air (BR)' },\n  { value: 'GF', label: 'Gulf Air (GF)' },\n  { value: 'LO', label: 'LOT Polish Airlines (LO)' },\n  { value: 'LH', label: 'Lufthansa (LH)' },\n  { value: 'WY', label: 'Oman Air (WY)' },\n  { value: 'SQ', label: 'Singapore Airlines (SQ)' },\n  { value: 'SA', label: 'South African Airways (SA)' },\n  { value: 'LX', label: 'Swiss International Air Lines (LX)' },\n  { value: 'TP', label: 'TAP Air Portugal (TP)' },\n  { value: 'TG', label: 'Thai Airways (TG)' },\n  { value: 'UA', label: 'United Airlines (UA)' }\n].sort((a, b) => a.label.localeCompare(b.label));\n\n// Helper function to calculate distance between two points using Haversine formula\nconst calculateDistance = (lat1, lon1, lat2, lon2) => {\n  const R = 6371; // Earth's radius in kilometers\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLon = (lon2 - lon1) * Math.PI / 180;\n  const a = \n    Math.sin(dLat/2) * Math.sin(dLat/2) +\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * \n    Math.sin(dLon/2) * Math.sin(dLon/2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n  return R * c;\n};\n\n// Calculate total distance for a route\nconst calculateRouteDistance = (route) => {\n  let totalDistance = 0;\n  \n  for (let i = 0; i < route.length; i++) {\n    const segment = route[i];\n    const departureAirport = airports.find(a => a.IATA === segment.Departure_IATA);\n    const arrivalAirport = airports.find(a => a.IATA === segment.Arrival_IATA);\n    \n    if (departureAirport && arrivalAirport) {\n      const segmentDistance = calculateDistance(\n        departureAirport.Latitude,\n        departureAirport.Longitude,\n        arrivalAirport.Latitude,\n        arrivalAirport.Longitude\n      );\n      totalDistance += segmentDistance;\n    }\n  }\n  \n  return totalDistance;\n};\n\n// ===============================\n// Hub Airport Exceptions\n// ===============================\n\n// Airports exempt from standard layover restrictions\nconst HUB_EXCEPTIONS = new Set([\n  // Star Alliance Hubs\n  'ATH', // Aegean\n  'PEK', 'CTU', 'PVG', // Air China\n  'DEL', 'BOM', // Air India\n  'AKL', 'WLG', 'CHC', // Air New Zealand\n  'HND', 'NRT', 'KIX', // ANA\n  'ICN', 'GMP', // Asiana\n  'VIE', // Austrian\n  'BOG', 'MDE', 'UIO', 'GUA', 'SAL', // Avianca\n  'BRU', // Brussels\n  'PTY', // Copa\n  'ZAG', // Croatia\n  'CAI', // EgyptAir\n  'ADD', // Ethiopian\n  'TPE', // EVA\n  'WAW', // LOT\n  'FRA', 'MUC', // Lufthansa\n  'SZX', // Shenzhen\n  'SIN', // Singapore\n  'JNB', // South African\n  'ZRH', 'GVA', // SWISS\n  'LIS', 'OPO', // TAP\n  'BKK', // Thai\n  'IST', // Turkish\n  'ORD', 'DEN', 'IAH', 'LAX', 'EWR', 'SFO', 'IAD', // United\n  // Non-Alliance Hubs\n  'YVO', 'YUL', // Air Creebec\n  'MUC', 'FRA', // Air Dolomiti\n  'MRU', // Air Mauritius\n  'BEG', // Air Serbia\n  'VCP', 'CNF', 'REC', // Azul\n  'YWG', 'YTH', // Calm Air\n  'YZF', 'YFB', // Canadian North\n  'HKG', // Cathay Pacific\n  'FRA', // Discover\n  'ZRH', // Edelweiss\n  'AUH', // Etihad\n  'DUS', 'CGN', 'HAM', 'STR', // Eurowings\n  'GRU', 'GIG', 'BSB', // GOL\n  'BAH', // Gulf Air\n  'PVG', 'SHA', // Juneyao\n  'ATH', // Olympic\n  'MCT', // Oman Air\n  'YYT', 'YHZ', // PAL Airlines\n  'AYT', 'ADB', // SunExpress\n  'BNE', 'MEL', 'SYD' // Virgin Australia\n]);\n\nexport function SearchPage() {\n  // State for selected airports and search results\n  const [departureAirport, setDepartureAirport] = useState('');\n  const [arrivalAirport, setArrivalAirport] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [showResults, setShowResults] = useState(false);\n  const [avoidCountries, setAvoidCountries] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [avoidAirlines, setAvoidAirlines] = useState([]);\n  const [maxSegments, setMaxSegments] = useState(4); // Default to 4\n\n  // Get the country options when component mounts\n  const countryOptions = useMemo(() => {\n    return getUniqueCountries(airports);\n  }, []);\n\n  // Calculates direct distance between airports using Haversine formula\n  function calculateDirectDistance(origin, destination) {\n    const originAirport = airports.find(a => a.IATA === origin);\n    const destAirport = airports.find(a => a.IATA === destination);\n    \n    if (!originAirport || !destAirport) return null;\n\n    const R = 3959; // Earth's radius in miles\n    const lat1 = originAirport.Latitude * Math.PI / 180;\n    const lat2 = destAirport.Latitude * Math.PI / 180;\n    const dLat = (destAirport.Latitude - originAirport.Latitude) * Math.PI / 180;\n    const dLon = (destAirport.Longitude - originAirport.Longitude) * Math.PI / 180;\n\n    const a = Math.sin(dLat/2) * Math.sin(dLat/2) +\n             Math.cos(lat1) * Math.cos(lat2) *\n             Math.sin(dLon/2) * Math.sin(dLon/2);\n    \n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    return R * c;\n  }\n\n  // Recursive function to find all valid routes between origin and destination\n  // Constraints:\n  // - Maximum 4 segments (3 stops)\n  // - Total distance <= 2x direct distance\n  // - No revisiting airports\n  // - No backtracking to previously visited countries (except direct connections)\n  // - Maximum 2 layovers in US/Canada unless both origin and destination are in US/Canada\n  const findPossibleRoutes = (origin, destination, visited = new Set(), visitedCountries = new Set(), path = [], directDistance = null) => {\n    // Create filtered allRoutes based on avoided airlines\n    const allRoutes = [\n      ...(avoidAirlines.includes('UA') ? [] : UA_miles),\n      ...(avoidAirlines.includes('SQ') ? [] : SQ_miles),\n      ...(avoidAirlines.includes('LH') ? [] : LH_miles),\n      ...(avoidAirlines.includes('LX') ? [] : LX_miles),\n      ...(avoidAirlines.includes('TG') ? [] : TG_miles),\n      ...(avoidAirlines.includes('BR') ? [] : BR_miles),\n      ...(avoidAirlines.includes('NH') ? [] : NH_miles),\n      ...(avoidAirlines.includes('OS') ? [] : OS_miles),\n      ...(avoidAirlines.includes('OZ') ? [] : OZ_miles),\n      ...(avoidAirlines.includes('NZ') ? [] : NZ_miles),\n      ...(avoidAirlines.includes('SA') ? [] : SA_miles),\n      ...(avoidAirlines.includes('AI') ? [] : AI_miles),\n      ...(avoidAirlines.includes('LO') ? [] : LO_miles),\n      ...(avoidAirlines.includes('SN') ? [] : SN_miles),\n      ...(avoidAirlines.includes('A3') ? [] : A3_miles),\n      ...(avoidAirlines.includes('TP') ? [] : TP_miles),\n      ...(avoidAirlines.includes('MS') ? [] : MS_miles),\n      ...(avoidAirlines.includes('WY') ? [] : WY_miles),\n      ...(avoidAirlines.includes('GF') ? [] : GF_miles),\n      ...(avoidAirlines.includes('AC') ? [] : AC_miles)\n    ];\n\n    const routes = [];\n\n    // Get origin and destination airport details for US/Canada check\n    const originAirport = airports.find(a => a.IATA === origin);\n    const destAirport = airports.find(a => a.IATA === destination);\n    const isOriginNorthAmerica = ['United States', 'Canada'].includes(originAirport?.Country);\n    const isDestNorthAmerica = ['United States', 'Canada'].includes(destAirport?.Country);\n    const bothInNorthAmerica = isOriginNorthAmerica && isDestNorthAmerica;\n\n    // Count existing North American layovers, treating non-hubs and hubs separately\n    const northAmericaLayovers = path.reduce((count, segment) => {\n      const layoverAirport = airports.find(a => a.IATA === segment.Arrival_IATA);\n      if (!layoverAirport || !['United States', 'Canada'].includes(layoverAirport.Country)) {\n        return count;\n      }\n      \n      if (HUB_EXCEPTIONS.has(segment.Arrival_IATA)) {\n        return { ...count, hubCount: 1 };  // All hubs count as 1 total\n      }\n      return { ...count, nonHubCount: count.nonHubCount + 1 };  // Each non-hub counts as 1\n    }, { nonHubCount: 0, hubCount: 0 });\n\n    // Count existing European layovers in the current path\n    const europeanLayovers = path.reduce((count, segment) => {\n      const layoverAirport = airports.find(a => a.IATA === segment.Arrival_IATA);\n      if (!layoverAirport || !EUROPEAN_COUNTRIES.has(layoverAirport.Country)) {\n        return count;\n      }\n      \n      // If it's a hub airport, we've already counted hubs, don't increment\n      if (HUB_EXCEPTIONS.has(segment.Arrival_IATA)) {\n        return count + (count.hasHub ? 0 : 1);  // Only count hubs once total\n      }\n      \n      // Non-hub European airports count as 1 each\n      return count + 1;\n    }, { total: 0, hasHub: false });\n\n    // Calculate direct distance if not provided\n    if (directDistance === null) {\n      directDistance = calculateDirectDistance(origin, destination);\n      if (!directDistance) return [];\n    }\n\n    // Base case: if we've found a path to the destination\n    if (path.length > 0 && path[path.length - 1].Arrival_IATA === destination) {\n      const totalDistance = path.reduce((sum, segment) => sum + segment.Distance, 0);\n      if (totalDistance <= directDistance * 2) {\n        return [path];\n      }\n      return [];\n    }\n\n    // Don't allow paths longer than 6 segments (5 stops)\n    if (path.length >= maxSegments) {\n      return [];\n    }\n\n    // Get current point and its country\n    const currentPoint = path.length === 0 ? origin : path[path.length - 1].Arrival_IATA;\n    const currentAirport = airports.find(a => a.IATA === currentPoint);\n    \n    if (!currentAirport) return [];\n\n    // Add helper function to count layovers by country\n    const getLayoverCountByCountry = (currentPath) => {\n      const countByCountry = {};\n      currentPath.forEach(segment => {\n        const airport = airports.find(a => a.IATA === segment.Arrival_IATA);\n        if (!airport) return;\n        \n        const country = airport.Country;\n        if (!countByCountry[country]) {\n          countByCountry[country] = { nonHubCount: 0, hasHub: false };\n        }\n        \n        if (HUB_EXCEPTIONS.has(segment.Arrival_IATA)) {\n          countByCountry[country].hasHub = true;\n        } else {\n          countByCountry[country].nonHubCount += 1;\n        }\n      });\n      return countByCountry;\n    };\n\n    const possibleSegments = allRoutes.filter(route => {\n      if (route[\"Departure IATA\"] !== currentPoint) return false;\n\n      // Get origin and destination countries\n      const originAirport = airports.find(a => a.IATA === origin);\n      const destAirport = airports.find(a => a.IATA === destination);\n      const thisArrivalAirport = airports.find(a => a.IATA === route[\"Arrival IATA\"]);\n      \n      if (!originAirport || !destAirport || !thisArrivalAirport) return false;\n\n      // Check for multiple layovers in same country\n      const countryLayovers = getLayoverCountByCountry(path);\n      const nextCountry = thisArrivalAirport.Country;\n      \n      // Allow multiple stops only if it's origin or destination country\n      if (nextCountry !== originAirport.Country && \n          nextCountry !== destAirport.Country && \n          countryLayovers[nextCountry] >= 1 &&\n          !HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) {\n        return false;\n      }\n\n      // Get zones\n      const originZone = airports.find(a => a.IATA === origin)?.Zone;\n      const destZone = airports.find(a => a.IATA === destination)?.Zone;\n      const connectZone = thisArrivalAirport?.Zone;\n\n      // Rule: When flying between two zones, cannot connect via a third zone\n      // Example: North America to Atlantic cannot connect via Pacific\n      if (originZone !== destZone && // Different zones\n          connectZone !== originZone && // Not in origin zone\n          connectZone !== destZone) { // Not in destination zone\n        return false;\n      }\n\n      // Add co-terminal validation\n      if (!isValidCoTerminalRoute(route, path)) {\n        return false;\n      }\n      \n      // Get the arrival airport details\n      const arrivalAirport = airports.find(a => a.IATA === route[\"Arrival IATA\"]);\n      if (!arrivalAirport) return false;\n\n      // Check if adding this segment would exceed US/Canada layover limit\n      const isArrivalNorthAmerica = ['United States', 'Canada'].includes(arrivalAirport.Country);\n      if (isArrivalNorthAmerica && !bothInNorthAmerica) {\n        let nextNonHubCount = northAmericaLayovers.nonHubCount;\n        let nextHubCount = northAmericaLayovers.hubCount;\n\n        if (HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) {\n          nextHubCount = 1;\n        } else {\n          nextNonHubCount += 1;\n        }\n\n        // Total layovers = non-hub count + hub count (all hubs count as 1)\n        if (nextNonHubCount + nextHubCount > 2) {\n          return false;\n        }\n      }\n\n      // Check if adding this segment would exceed European layover limit\n      const isEuropeanArrival = EUROPEAN_COUNTRIES.has(arrivalAirport.Country);\n      const isEuropeanHub = HUB_EXCEPTIONS.has(route[\"Arrival IATA\"]);\n      \n      if (isEuropeanArrival) {\n        let newLayoverCount = europeanLayovers;\n        if (isEuropeanHub && !europeanLayovers.hasHub) {\n          newLayoverCount += 1;  // First hub encounter counts as 1\n        } else if (!isEuropeanHub) {\n          newLayoverCount += 1;  // Non-hub counts as 1\n        }\n        if (newLayoverCount > 2) {\n          return false;\n        }\n      }\n\n      // Check if we're not backtracking to a visited airport\n      if (visited.has(route[\"Arrival IATA\"])) return false;\n\n      // Check if we're not backtracking to a visited country\n      // Exception: Allow same country connection if it's a direct continuation\n      const isBacktrackingCountry = visitedCountries.has(arrivalAirport.Country) &&\n                                  arrivalAirport.Country !== currentAirport.Country;\n      if (isBacktrackingCountry) return false;\n\n      // Rule: Maximum 1 layover per transit country (with hub exceptions)\n      const layoverCounts = getLayoverCountByCountry(path);\n      const arrivalCountry = arrivalAirport.Country;\n      if (arrivalCountry !== originAirport.Country && \n          arrivalCountry !== destAirport.Country && \n          layoverCounts[arrivalCountry] >= 1 &&\n          !HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) { // Add exception check\n        return false;\n      }\n\n      // Rule: Maximum 2 stops in Europe (with hub exceptions)\n      if (isEuropeanArrival && \n          europeanLayovers >= 2 &&\n          !HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) { // Add exception check\n        return false;\n      }\n\n      // Check if adding this stop would exceed country limit\n      if (nextCountry !== originAirport.Country && nextCountry !== destAirport.Country) {\n        const currentCount = countryLayovers[nextCountry] || { nonHubCount: 0, hasHub: false };\n        let totalStops = currentCount.nonHubCount;\n        if (currentCount.hasHub || HUB_EXCEPTIONS.has(route[\"Arrival IATA\"])) {\n          totalStops += 1; // All hubs in country count as 1 total\n        }\n        if (totalStops >= 2) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n\n    // Try each possible next segment\n    for (const segment of possibleSegments) {\n      const arrivalAirport = airports.find(a => a.IATA === segment[\"Arrival IATA\"]);\n      \n      // Calculate running total distance\n      const currentTotalDistance = path.reduce((sum, seg) => sum + seg.Distance, 0) + \n                               segment[\"Flight Distance (miles)\"];\n      \n      // Skip this path if it's already over 2x direct distance\n      if (currentTotalDistance > directDistance * 2) {\n        continue;\n      }\n\n      // Update visited sets\n      const newVisited = new Set(visited);\n      newVisited.add(segment[\"Arrival IATA\"]);\n      \n      const newVisitedCountries = new Set(visitedCountries);\n      newVisitedCountries.add(arrivalAirport.Country);\n\n      const newPath = [...path, {\n        Departure_IATA: segment[\"Departure IATA\"],\n        Arrival_IATA: segment[\"Arrival IATA\"],\n        Distance: segment[\"Flight Distance (miles)\"],\n        Country: arrivalAirport.Country // Add country info for reference\n      }];\n\n      const newRoutes = findPossibleRoutes(\n        origin,\n        destination,\n        newVisited,\n        newVisitedCountries,\n        newPath,\n        directDistance\n      );\n\n      routes.push(...newRoutes);\n    }\n\n    return routes;\n  };\n\n  // Handles the search button click\n  // Updates URL parameters and finds possible routes\n  const handleSearch = async () => {\n    // Show loading overlay immediately\n    setIsLoading(true);\n    setShowResults(false);\n\n    try {\n      // Wait for 250ms to ensure overlay is visible\n      await new Promise(resolve => setTimeout(resolve, 250));\n\n      if (departureAirport && arrivalAirport) {\n        const params = new URLSearchParams();\n        params.set('from', departureAirport);\n        params.set('to', arrivalAirport);\n        params.set('avoidCountries', avoidCountries.join(','));\n        \n        window.history.pushState(\n          {}, \n          '', \n          `${window.location.pathname}?${params.toString()}`\n        );\n        \n        const originAirport = airports.find(a => a.IATA === departureAirport);\n        const visited = new Set([departureAirport]);\n        const visitedCountries = new Set([originAirport.Country]);\n        \n        const routes = findPossibleRoutes(\n          departureAirport, \n          arrivalAirport, \n          visited,\n          visitedCountries\n        );\n        \n        // Filter out routes that go through avoided countries\n        const filteredRoutes = routes.filter(route => \n          isRouteAvoidingCountries(route, avoidCountries)\n        );\n        \n        // Sort routes by total distance\n        const sortedRoutes = filteredRoutes.sort((a, b) => {\n          const distanceA = calculateRouteDistance(a);\n          const distanceB = calculateRouteDistance(b);\n          return distanceA - distanceB; // Low to high\n        });\n        \n        setSearchResults(sortedRoutes);\n        setShowResults(true);\n      }\n    } catch (error) {\n      console.error('Error searching routes:', error);\n    } finally {\n      // Add a small delay before hiding loading screen for smoother transition\n      await new Promise(resolve => setTimeout(resolve, 100));\n      setIsLoading(false);\n    }\n  };\n\n  // Airport search with better IATA and name prioritization\n  const getAirportOptions = (inputValue) => {\n    if (!inputValue) return [];\n    \n    const input = inputValue.toLowerCase().trim();\n    \n    // Priority 1: Exact IATA match\n    const exactIataMatches = airports.filter(airport => \n      airport.IATA.toLowerCase() === input\n    );\n\n    // Priority 2: IATA starts with input\n    const startingIataMatches = airports.filter(airport => \n      airport.IATA.toLowerCase().startsWith(input) &&\n      !exactIataMatches.includes(airport)\n    );\n\n    // Priority 3: Airport name starts with input\n    const startingNameMatches = airports.filter(airport => \n      airport.Name.toLowerCase().startsWith(input) &&\n      !exactIataMatches.includes(airport) &&\n      !startingIataMatches.includes(airport)\n    );\n\n    // Priority 4: Airport name contains input\n    const containingNameMatches = airports.filter(airport => \n      airport.Name.toLowerCase().includes(input) &&\n      !exactIataMatches.includes(airport) &&\n      !startingIataMatches.includes(airport) &&\n      !startingNameMatches.includes(airport)\n    );\n\n    // Combine all matches with proper ordering\n    const allMatches = [\n      ...exactIataMatches,\n      ...startingIataMatches,\n      ...startingNameMatches,\n      ...containingNameMatches\n    ].slice(0, 5); // Limit to 5 results\n\n    return allMatches.map(airport => ({\n      value: airport.IATA,\n      label: `${airport.IATA} - ${airport.Name} (${airport.Country})`\n    }));\n  };\n\n  // Country search with progressive character matching\n  const getCountryOptions = (inputValue) => {\n    if (!inputValue) return [];\n\n    const input = inputValue.toLowerCase().trim();\n    const countries = getUniqueCountries(airports);\n    \n    // First: Exact matches\n    const exactMatches = countries.filter(country => \n      country.toLowerCase() === input\n    );\n\n    // Second: Starting matches (progressive matching)\n    const startingMatches = countries.filter(country => \n      country.toLowerCase().startsWith(input) &&\n      !exactMatches.includes(country)\n    );\n\n    // Third: Progressive character matching\n    const progressiveMatches = countries.filter(country => {\n      if (exactMatches.includes(country) || startingMatches.includes(country)) {\n        return false;\n      }\n      \n      const countryChars = country.toLowerCase();\n      let lastIndex = -1;\n      \n      // Check if characters appear in sequence\n      for (const char of input) {\n        const index = countryChars.indexOf(char, lastIndex + 1);\n        if (index === -1) return false;\n        lastIndex = index;\n      }\n      \n      return true;\n    });\n\n    // Combine all matches with proper ordering\n    const allMatches = [\n      ...exactMatches,\n      ...startingMatches,\n      ...progressiveMatches\n    ].slice(0, 5); // Limit to 5 results\n\n    return allMatches.map(country => ({\n      value: country,\n      label: country\n    }));\n  };\n\n  const filterCountries = (inputValue) => {\n    if (!inputValue) return [];\n    \n    const input = inputValue.toLowerCase().trim();\n    const countries = getUniqueCountries(airports);\n    \n    // Priority 1: Exact matches\n    const exactMatches = countries.filter(country => \n      country.toLowerCase() === input\n    );\n\n    // Priority 2: Starts with input\n    const startingMatches = countries.filter(country => \n      country.toLowerCase().startsWith(input) &&\n      !exactMatches.includes(country)\n    );\n\n    // Priority 3: Contains input\n    const containingMatches = countries.filter(country => \n      country.toLowerCase().includes(input) &&\n      !exactMatches.includes(country) &&\n      !startingMatches.includes(country)\n    );\n\n    return [...exactMatches, ...startingMatches, ...containingMatches]\n      .slice(0, 5)\n      .map(country => ({\n        value: country,\n        label: country\n      }));\n  };\n\n  const loadCountryOptions = (inputValue) => \n    new Promise((resolve) => {\n      resolve(filterCountries(inputValue));\n    });\n\n  const filterAirports = (inputValue) => {\n    if (!inputValue) return [];\n    \n    const input = inputValue.toLowerCase().trim();\n    \n    // Filter out airports from avoided countries first\n    const availableAirports = airports.filter(airport => \n      !avoidCountries.includes(airport.Country)\n    );\n    \n    // Priority 1: Exact IATA match\n    const exactIataMatches = availableAirports.filter(airport => \n      airport.IATA.toLowerCase() === input\n    );\n\n    // Priority 2: IATA starts with input\n    const startingIataMatches = availableAirports.filter(airport => \n      airport.IATA.toLowerCase().startsWith(input) &&\n      !exactIataMatches.includes(airport)\n    );\n\n    // Priority 3: Airport name starts with input\n    const startingNameMatches = availableAirports.filter(airport => \n      airport.Name.toLowerCase().startsWith(input) &&\n      !exactIataMatches.includes(airport) &&\n      !startingIataMatches.includes(airport)\n    );\n\n    // Priority 4: Airport name contains input\n    const containingNameMatches = availableAirports.filter(airport => \n      airport.Name.toLowerCase().includes(input) &&\n      !exactIataMatches.includes(airport) &&\n      !startingIataMatches.includes(airport) &&\n      !startingNameMatches.includes(airport)\n    );\n\n    // Combine all matches with proper ordering\n    const allMatches = [\n      ...exactIataMatches,\n      ...startingIataMatches,\n      ...startingNameMatches,\n      ...containingNameMatches\n    ].slice(0, 5); // Limit to 5 results\n\n    return allMatches.map(airport => ({\n      value: airport.IATA,\n      label: `${airport.IATA} - ${airport.Name} (${airport.Country})`\n    }));\n  };\n\n  const loadAirportOptions = (inputValue) => \n    new Promise((resolve) => {\n      resolve(filterAirports(inputValue));\n    });\n\n  // Filter airlines function\n  const filterAirlines = (inputValue) => {\n    if (!inputValue) return airlines;\n    \n    const input = inputValue.toLowerCase().trim();\n    \n    // Priority 1: Exact airline code match\n    const exactCodeMatches = airlines.filter(airline => \n      airline.value.toLowerCase() === input\n    );\n\n    // Priority 2: Starting airline code match\n    const startingCodeMatches = airlines.filter(airline => \n      airline.value.toLowerCase().startsWith(input) &&\n      !exactCodeMatches.includes(airline)\n    );\n\n    // Priority 3: Airline name contains input\n    const nameMatches = airlines.filter(airline => \n      airline.label.toLowerCase().includes(input) &&\n      !exactCodeMatches.includes(airline) &&\n      !startingCodeMatches.includes(airline)\n    );\n\n    return [...exactCodeMatches, ...startingCodeMatches, ...nameMatches];\n  };\n\n  const loadAirlineOptions = (inputValue) => \n    new Promise((resolve) => {\n      resolve(filterAirlines(inputValue));\n    });\n\n  // Also clear selected airports if their country is now avoided\n  useEffect(() => {\n    if (departureAirport) {\n      const departureCountry = airports.find(a => a.IATA === departureAirport)?.Country;\n      if (departureCountry && avoidCountries.includes(departureCountry)) {\n        setDepartureAirport('');\n      }\n    }\n    \n    if (arrivalAirport) {\n      const arrivalCountry = airports.find(a => a.IATA === arrivalAirport)?.Country;\n      if (arrivalCountry && avoidCountries.includes(arrivalCountry)) {\n        setArrivalAirport('');\n      }\n    }\n  }, [avoidCountries, departureAirport, arrivalAirport]);\n\n  // Update URL when form changes\n  useEffect(() => {\n    const params = new URLSearchParams();\n    if (departureAirport) params.set('from', departureAirport);\n    if (arrivalAirport) params.set('to', arrivalAirport);\n    if (avoidCountries.length > 0) params.set('avoid', avoidCountries.join(','));\n    if (maxSegments !== 4) params.set('max', maxSegments.toString()); // Only add if not default\n    \n    const newUrl = `${window.location.pathname}${params.toString() ? '?' + params.toString() : ''}`;\n    window.history.replaceState({}, '', newUrl);\n  }, [departureAirport, arrivalAirport, avoidCountries, maxSegments]);\n\n  // Read URL params on initial load\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const originParam = params.get('from');\n    const destParam = params.get('to');\n    const avoidParam = params.get('avoid');\n    const maxParam = params.get('max');\n\n    if (originParam) setDepartureAirport(originParam);\n    if (destParam) setArrivalAirport(destParam);\n    if (avoidParam) setAvoidCountries(avoidParam.split(','));\n    if (maxParam) {\n      const maxValue = parseInt(maxParam, 10);\n      if (!isNaN(maxValue) && maxValue >= 0 && maxValue <= 6) {\n        setMaxSegments(maxValue);\n      }\n    }\n  }, []);\n\n  return (\n    <div className=\"search-container\">\n      <div className=\"search-boxes\">\n        <div className=\"airport-search\">\n          <div className=\"search-parameter departure-parameter\">\n            <label style={{ fontWeight: 700 }}>Departure Airport:</label>\n            <AsyncSelect\n              className=\"select-input\"\n              cacheOptions\n              defaultOptions\n              value={departureAirport ? {\n                value: departureAirport,\n                label: airports.find(a => a.IATA === departureAirport)?.IATA + \n                  \" - \" + airports.find(a => a.IATA === departureAirport)?.Name +\n                  \" (\" + airports.find(a => a.IATA === departureAirport)?.Country + \")\"\n              } : null}\n              loadOptions={loadAirportOptions}\n              onChange={(selected) => setDepartureAirport(selected ? selected.value : '')}\n              isDisabled={isLoading}\n              placeholder=\"Select airports...\"\n            />\n          </div>\n          <div className=\"search-parameter arrival-parameter\">\n            <label style={{ fontWeight: 700 }}>Arrival Airport:</label>\n            <AsyncSelect\n              className=\"select-input\"\n              cacheOptions\n              defaultOptions\n              value={arrivalAirport ? {\n                value: arrivalAirport,\n                label: airports.find(a => a.IATA === arrivalAirport)?.IATA + \n                  \" - \" + airports.find(a => a.IATA === arrivalAirport)?.Name +\n                  \" (\" + airports.find(a => a.IATA === arrivalAirport)?.Country + \")\"\n              } : null}\n              loadOptions={loadAirportOptions}\n              onChange={(selected) => setArrivalAirport(selected ? selected.value : '')}\n              isDisabled={isLoading}\n              placeholder=\"Select airports...\"\n            />\n          </div>\n        </div>\n        <div className=\"search-parameter\">\n          <label>Avoid Countries:</label>\n          <AsyncSelect\n            isMulti\n            className=\"select-input avoid-countries-select\"\n            cacheOptions\n            defaultOptions\n            value={avoidCountries.map(country => ({\n              value: country,\n              label: country\n            }))}\n            loadOptions={loadCountryOptions}\n            onChange={(selected) => {\n              setAvoidCountries(selected ? selected.map(option => option.value) : []);\n            }}\n            isDisabled={isLoading}\n            placeholder=\"Select countries...\"\n          />\n        </div>\n        <div className=\"search-parameter\">\n          <label>Avoid Airlines:</label>\n          <AsyncSelect\n            isMulti\n            className=\"select-input avoid-airlines-select\"\n            cacheOptions\n            defaultOptions={airlines}\n            value={avoidAirlines.map(airline => ({\n              value: airline,\n              label: airlines.find(a => a.value === airline)?.label || airline\n            }))}\n            loadOptions={loadAirlineOptions}\n            onChange={(selected) => {\n              setAvoidAirlines(selected ? selected.map(option => option.value) : []);\n            }}\n            isDisabled={isLoading}\n            placeholder=\"Select airlines to avoid...\"\n          />\n        </div>\n        <div className=\"search-parameter max-segments-parameter\">\n          <label>Maximum Segments</label>\n          <input\n            type=\"number\"\n            min=\"0\"\n            max=\"6\"\n            value={maxSegments}\n            onChange={(e) => {\n              const value = parseInt(e.target.value, 10);\n              if (!isNaN(value) && value >= 0 && value <= 6) {\n                setMaxSegments(value);\n              }\n            }}\n          />\n        </div>\n        <button \n          className=\"search-button\"\n          onClick={handleSearch}\n          disabled={isLoading || !departureAirport || !arrivalAirport}\n        >\n          {isLoading ? 'Searching...' : 'Search'}\n        </button>\n      </div>\n      <FlightResults \n        results={searchResults} \n        isVisible={showResults}\n      />\n      \n      {isLoading && (\n        <div className=\"loading-overlay\">\n          <div className=\"loading-spinner\"></div>\n          <div className=\"loading-text\">Searching for routes...</div>\n        </div>\n      )}\n    </div>\n  );\n} \n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,OAAO,QAAQ,OAAO;AAC3D,SAASC,aAAa,QAAQ,iBAAiB;AAC/C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,kBAAkB,QAAQ,uBAAuB;AAC1D,OAAOC,MAAM,MAAM,cAAc;AACjC,OAAOC,WAAW,MAAM,oBAAoB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7C,MAAMC,WAAW,GAAG;EAClB;EACA,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EAC5B,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EAC5B,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EAC5B,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EAErB;EACA,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EAE5B;EACA,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EAC1C,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EAC5B,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EACnC,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EAErB;EACA,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EAC5B,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrB,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK;AACtB,CAAC;AAED,SAASC,kBAAkBA,CAACC,OAAO,EAAE;EACnC,KAAK,MAAM,CAACC,KAAK,EAAET,QAAQ,CAAC,IAAIU,MAAM,CAACC,OAAO,CAACL,WAAW,CAAC,EAAE;IAC3D,IAAIN,QAAQ,CAACY,QAAQ,CAACJ,OAAO,CAAC,EAAE;MAC9B,OAAOC,KAAK;IACd;EACF;EACA,OAAO,IAAI;AACb;AAEA,SAASI,sBAAsBA,CAACC,UAAU,EAAEC,YAAY,EAAE;EACxD,MAAMC,WAAW,GAAG,CAClB,GAAGD,YAAY,CAACE,GAAG,CAACC,GAAG,IAAIA,GAAG,CAACC,cAAc,CAAC,EAC9C,GAAGJ,YAAY,CAACE,GAAG,CAACC,GAAG,IAAIA,GAAG,CAACE,YAAY,CAAC,EAC5CN,UAAU,CAAC,gBAAgB,CAAC,EAC5BA,UAAU,CAAC,cAAc,CAAC,CAC3B;EAED,MAAMO,eAAe,GAAG,IAAIC,GAAG,CAAC,CAAC;EAEjC,KAAK,MAAMd,OAAO,IAAIQ,WAAW,EAAE;IACjC,MAAMO,eAAe,GAAGhB,kBAAkB,CAACC,OAAO,CAAC;IACnD,IAAIe,eAAe,EAAE;MACnB,IAAIF,eAAe,CAACG,GAAG,CAACD,eAAe,CAAC,EAAE;QACxC;QACA,IAAIF,eAAe,CAACI,GAAG,CAACF,eAAe,CAAC,KAAKf,OAAO,EAAE;UACpD,OAAO,KAAK;QACd;MACF,CAAC,MAAM;QACLa,eAAe,CAACK,GAAG,CAACH,eAAe,EAAEf,OAAO,CAAC;MAC/C;IACF;EACF;EAEA,OAAO,IAAI;AACb;;AAEA;AACA,MAAMmB,kBAAkB,GAAG,IAAIC,GAAG,CAAC,CACjC,SAAS,EAAE,gBAAgB,EAAE,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAC5E,SAAS,EAAE,aAAa,EAAE,SAAS,EAAE,SAAS,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAC9E,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,aAAa,EAAE,UAAU,EAAE,QAAQ,EAAE,SAAS,EAC/E,SAAS,EAAE,QAAQ,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,wBAAwB,EAC/E,SAAS,EAAE,WAAW,EAAE,SAAS,EAAE,UAAU,EAAE,QAAQ,EAAE,iBAAiB,EAC1E,SAAS,EAAE,YAAY,EAAE,YAAY,EAAE,OAAO,EAAE,SAAS,CAC1D,CAAC;;AAEF;AACA,MAAMC,wBAAwB,GAAGA,CAACC,KAAK,EAAEC,cAAc,KAAK;EAC1D;EACA,KAAK,MAAMC,OAAO,IAAIF,KAAK,EAAE;IAC3B,MAAMG,gBAAgB,GAAGjC,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKJ,OAAO,CAACb,cAAc,CAAC;IAC9E,MAAMkB,cAAc,GAAGrC,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKJ,OAAO,CAACZ,YAAY,CAAC;;IAE1E;IACA,IAAIa,gBAAgB,IAAIF,cAAc,CAACnB,QAAQ,CAACqB,gBAAgB,CAACK,OAAO,CAAC,EAAE;MACzE,OAAO,KAAK;IACd;IACA,IAAID,cAAc,IAAIN,cAAc,CAACnB,QAAQ,CAACyB,cAAc,CAACC,OAAO,CAAC,EAAE;MACrE,OAAO,KAAK;IACd;EACF;EACA,OAAO,IAAI;AACb,CAAC;;AAED;AACA,MAAMC,QAAQ,GAAG,CACf;EAAEC,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAuB,CAAC,EAC9C;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAkB,CAAC,EACzC;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAiB,CAAC,EACxC;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAuB,CAAC,EAC9C;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAA0B,CAAC,EACjD;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAuB,CAAC,EAC9C;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAyB,CAAC,EAChD;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAyB,CAAC,EAChD;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAgB,CAAC,EACvC;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAe,CAAC,EACtC;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAgB,CAAC,EACvC;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAA2B,CAAC,EAClD;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAiB,CAAC,EACxC;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAgB,CAAC,EACvC;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAA0B,CAAC,EACjD;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAA6B,CAAC,EACpD;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAqC,CAAC,EAC5D;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAwB,CAAC,EAC/C;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAoB,CAAC,EAC3C;EAAED,KAAK,EAAE,IAAI;EAAEC,KAAK,EAAE;AAAuB,CAAC,CAC/C,CAACC,IAAI,CAAC,CAACP,CAAC,EAAEQ,CAAC,KAAKR,CAAC,CAACM,KAAK,CAACG,aAAa,CAACD,CAAC,CAACF,KAAK,CAAC,CAAC;;AAEhD;AACA,MAAMI,iBAAiB,GAAGA,CAACC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,KAAK;EACpD,MAAMC,CAAC,GAAG,IAAI,CAAC,CAAC;EAChB,MAAMC,IAAI,GAAG,CAACH,IAAI,GAAGF,IAAI,IAAIM,IAAI,CAACC,EAAE,GAAG,GAAG;EAC1C,MAAMC,IAAI,GAAG,CAACL,IAAI,GAAGF,IAAI,IAAIK,IAAI,CAACC,EAAE,GAAG,GAAG;EAC1C,MAAMlB,CAAC,GACLiB,IAAI,CAACG,GAAG,CAACJ,IAAI,GAAC,CAAC,CAAC,GAAGC,IAAI,CAACG,GAAG,CAACJ,IAAI,GAAC,CAAC,CAAC,GACnCC,IAAI,CAACI,GAAG,CAACV,IAAI,GAAGM,IAAI,CAACC,EAAE,GAAG,GAAG,CAAC,GAAGD,IAAI,CAACI,GAAG,CAACR,IAAI,GAAGI,IAAI,CAACC,EAAE,GAAG,GAAG,CAAC,GAC/DD,IAAI,CAACG,GAAG,CAACD,IAAI,GAAC,CAAC,CAAC,GAAGF,IAAI,CAACG,GAAG,CAACD,IAAI,GAAC,CAAC,CAAC;EACrC,MAAMG,CAAC,GAAG,CAAC,GAAGL,IAAI,CAACM,KAAK,CAACN,IAAI,CAACO,IAAI,CAACxB,CAAC,CAAC,EAAEiB,IAAI,CAACO,IAAI,CAAC,CAAC,GAACxB,CAAC,CAAC,CAAC;EACtD,OAAOe,CAAC,GAAGO,CAAC;AACd,CAAC;;AAED;AACA,MAAMG,sBAAsB,GAAI9B,KAAK,IAAK;EACxC,IAAI+B,aAAa,GAAG,CAAC;EAErB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGhC,KAAK,CAACiC,MAAM,EAAED,CAAC,EAAE,EAAE;IACrC,MAAM9B,OAAO,GAAGF,KAAK,CAACgC,CAAC,CAAC;IACxB,MAAM7B,gBAAgB,GAAGjC,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKJ,OAAO,CAACb,cAAc,CAAC;IAC9E,MAAMkB,cAAc,GAAGrC,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKJ,OAAO,CAACZ,YAAY,CAAC;IAE1E,IAAIa,gBAAgB,IAAII,cAAc,EAAE;MACtC,MAAM2B,eAAe,GAAGnB,iBAAiB,CACvCZ,gBAAgB,CAACgC,QAAQ,EACzBhC,gBAAgB,CAACiC,SAAS,EAC1B7B,cAAc,CAAC4B,QAAQ,EACvB5B,cAAc,CAAC6B,SACjB,CAAC;MACDL,aAAa,IAAIG,eAAe;IAClC;EACF;EAEA,OAAOH,aAAa;AACtB,CAAC;;AAED;AACA;AACA;;AAEA;AACA,MAAMM,cAAc,GAAG,IAAIvC,GAAG,CAAC;AAC7B;AACA,KAAK;AAAE;AACP,KAAK,EAAE,KAAK,EAAE,KAAK;AAAE;AACrB,KAAK,EAAE,KAAK;AAAE;AACd,KAAK,EAAE,KAAK,EAAE,KAAK;AAAE;AACrB,KAAK,EAAE,KAAK,EAAE,KAAK;AAAE;AACrB,KAAK,EAAE,KAAK;AAAE;AACd,KAAK;AAAE;AACP,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK;AAAE;AACnC,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK,EAAE,KAAK;AAAE;AACd,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK,EAAE,KAAK;AAAE;AACd,KAAK,EAAE,KAAK;AAAE;AACd,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK;AAAE;AACjD;AACA,KAAK,EAAE,KAAK;AAAE;AACd,KAAK,EAAE,KAAK;AAAE;AACd,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK,EAAE,KAAK,EAAE,KAAK;AAAE;AACrB,KAAK,EAAE,KAAK;AAAE;AACd,KAAK,EAAE,KAAK;AAAE;AACd,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK;AAAE;AAC5B,KAAK,EAAE,KAAK,EAAE,KAAK;AAAE;AACrB,KAAK;AAAE;AACP,KAAK,EAAE,KAAK;AAAE;AACd,KAAK;AAAE;AACP,KAAK;AAAE;AACP,KAAK,EAAE,KAAK;AAAE;AACd,KAAK,EAAE,KAAK;AAAE;AACd,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;AAAA,CACrB,CAAC;AAEF,OAAO,SAASwC,UAAUA,CAAA,EAAG;EAAAC,EAAA;EAAA,IAAAC,eAAA,EAAAC,eAAA,EAAAC,eAAA,EAAAC,eAAA,EAAAC,eAAA,EAAAC,gBAAA;EAC3B;EACA,MAAM,CAAC1C,gBAAgB,EAAE2C,mBAAmB,CAAC,GAAGpG,QAAQ,CAAC,EAAE,CAAC;EAC5D,MAAM,CAAC6D,cAAc,EAAEwC,iBAAiB,CAAC,GAAGrG,QAAQ,CAAC,EAAE,CAAC;EACxD,MAAM,CAACsG,aAAa,EAAEC,gBAAgB,CAAC,GAAGvG,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACwG,WAAW,EAAEC,cAAc,CAAC,GAAGzG,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACuD,cAAc,EAAEmD,iBAAiB,CAAC,GAAG1G,QAAQ,CAAC,EAAE,CAAC;EACxD,MAAM,CAAC2G,SAAS,EAAEC,YAAY,CAAC,GAAG5G,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAAC6G,aAAa,EAAEC,gBAAgB,CAAC,GAAG9G,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAAC+G,WAAW,EAAEC,cAAc,CAAC,GAAGhH,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;;EAEnD;EACA,MAAMiH,cAAc,GAAG/G,OAAO,CAAC,MAAM;IACnC,OAAOuB,kBAAkB,CAACD,QAAQ,CAAC;EACrC,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,SAAS0F,uBAAuBA,CAACC,MAAM,EAAEC,WAAW,EAAE;IACpD,MAAMC,aAAa,GAAG7F,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKuD,MAAM,CAAC;IAC3D,MAAMG,WAAW,GAAG9F,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKwD,WAAW,CAAC;IAE9D,IAAI,CAACC,aAAa,IAAI,CAACC,WAAW,EAAE,OAAO,IAAI;IAE/C,MAAM5C,CAAC,GAAG,IAAI,CAAC,CAAC;IAChB,MAAMJ,IAAI,GAAG+C,aAAa,CAAC5B,QAAQ,GAAGb,IAAI,CAACC,EAAE,GAAG,GAAG;IACnD,MAAML,IAAI,GAAG8C,WAAW,CAAC7B,QAAQ,GAAGb,IAAI,CAACC,EAAE,GAAG,GAAG;IACjD,MAAMF,IAAI,GAAG,CAAC2C,WAAW,CAAC7B,QAAQ,GAAG4B,aAAa,CAAC5B,QAAQ,IAAIb,IAAI,CAACC,EAAE,GAAG,GAAG;IAC5E,MAAMC,IAAI,GAAG,CAACwC,WAAW,CAAC5B,SAAS,GAAG2B,aAAa,CAAC3B,SAAS,IAAId,IAAI,CAACC,EAAE,GAAG,GAAG;IAE9E,MAAMlB,CAAC,GAAGiB,IAAI,CAACG,GAAG,CAACJ,IAAI,GAAC,CAAC,CAAC,GAAGC,IAAI,CAACG,GAAG,CAACJ,IAAI,GAAC,CAAC,CAAC,GACpCC,IAAI,CAACI,GAAG,CAACV,IAAI,CAAC,GAAGM,IAAI,CAACI,GAAG,CAACR,IAAI,CAAC,GAC/BI,IAAI,CAACG,GAAG,CAACD,IAAI,GAAC,CAAC,CAAC,GAAGF,IAAI,CAACG,GAAG,CAACD,IAAI,GAAC,CAAC,CAAC;IAE5C,MAAMG,CAAC,GAAG,CAAC,GAAGL,IAAI,CAACM,KAAK,CAACN,IAAI,CAACO,IAAI,CAACxB,CAAC,CAAC,EAAEiB,IAAI,CAACO,IAAI,CAAC,CAAC,GAACxB,CAAC,CAAC,CAAC;IACtD,OAAOe,CAAC,GAAGO,CAAC;EACd;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,MAAMsC,kBAAkB,GAAGA,CAACJ,MAAM,EAAEC,WAAW,EAAEI,OAAO,GAAG,IAAIpE,GAAG,CAAC,CAAC,EAAEqE,gBAAgB,GAAG,IAAIrE,GAAG,CAAC,CAAC,EAAEsE,IAAI,GAAG,EAAE,EAAEC,cAAc,GAAG,IAAI,KAAK;IACvI;IACA,MAAMC,SAAS,GAAG,CAChB,IAAIf,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGhC,QAAQ,CAAC,EACjD,IAAIyG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG/B,QAAQ,CAAC,EACjD,IAAIwG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG9B,QAAQ,CAAC,EACjD,IAAIuG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG7B,QAAQ,CAAC,EACjD,IAAIsG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG5B,QAAQ,CAAC,EACjD,IAAIqG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG3B,QAAQ,CAAC,EACjD,IAAIoG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG1B,QAAQ,CAAC,EACjD,IAAImG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGzB,QAAQ,CAAC,EACjD,IAAIkG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGxB,QAAQ,CAAC,EACjD,IAAIiG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGvB,QAAQ,CAAC,EACjD,IAAIgG,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGtB,QAAQ,CAAC,EACjD,IAAI+F,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGrB,QAAQ,CAAC,EACjD,IAAI8F,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGpB,QAAQ,CAAC,EACjD,IAAI6F,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGnB,QAAQ,CAAC,EACjD,IAAI4F,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGlB,QAAQ,CAAC,EACjD,IAAI2F,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGjB,QAAQ,CAAC,EACjD,IAAI0F,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGhB,QAAQ,CAAC,EACjD,IAAIyF,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGf,QAAQ,CAAC,EACjD,IAAIwF,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGd,QAAQ,CAAC,EACjD,IAAIuF,aAAa,CAACzE,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAGb,QAAQ,CAAC,CAClD;IAED,MAAMsG,MAAM,GAAG,EAAE;;IAEjB;IACA,MAAMR,aAAa,GAAG7F,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKuD,MAAM,CAAC;IAC3D,MAAMG,WAAW,GAAG9F,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKwD,WAAW,CAAC;IAC9D,MAAMU,oBAAoB,GAAG,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC1F,QAAQ,CAACiF,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEvD,OAAO,CAAC;IACzF,MAAMiE,kBAAkB,GAAG,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC3F,QAAQ,CAACkF,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAExD,OAAO,CAAC;IACrF,MAAMkE,kBAAkB,GAAGF,oBAAoB,IAAIC,kBAAkB;;IAErE;IACA,MAAME,oBAAoB,GAAGP,IAAI,CAACQ,MAAM,CAAC,CAACC,KAAK,EAAE3E,OAAO,KAAK;MAC3D,MAAM4E,cAAc,GAAG5G,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKJ,OAAO,CAACZ,YAAY,CAAC;MAC1E,IAAI,CAACwF,cAAc,IAAI,CAAC,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAChG,QAAQ,CAACgG,cAAc,CAACtE,OAAO,CAAC,EAAE;QACpF,OAAOqE,KAAK;MACd;MAEA,IAAIxC,cAAc,CAAC3C,GAAG,CAACQ,OAAO,CAACZ,YAAY,CAAC,EAAE;QAC5C,OAAO;UAAE,GAAGuF,KAAK;UAAEE,QAAQ,EAAE;QAAE,CAAC,CAAC,CAAE;MACrC;MACA,OAAO;QAAE,GAAGF,KAAK;QAAEG,WAAW,EAAEH,KAAK,CAACG,WAAW,GAAG;MAAE,CAAC,CAAC,CAAE;IAC5D,CAAC,EAAE;MAAEA,WAAW,EAAE,CAAC;MAAED,QAAQ,EAAE;IAAE,CAAC,CAAC;;IAEnC;IACA,MAAME,gBAAgB,GAAGb,IAAI,CAACQ,MAAM,CAAC,CAACC,KAAK,EAAE3E,OAAO,KAAK;MACvD,MAAM4E,cAAc,GAAG5G,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKJ,OAAO,CAACZ,YAAY,CAAC;MAC1E,IAAI,CAACwF,cAAc,IAAI,CAACjF,kBAAkB,CAACH,GAAG,CAACoF,cAAc,CAACtE,OAAO,CAAC,EAAE;QACtE,OAAOqE,KAAK;MACd;;MAEA;MACA,IAAIxC,cAAc,CAAC3C,GAAG,CAACQ,OAAO,CAACZ,YAAY,CAAC,EAAE;QAC5C,OAAOuF,KAAK,IAAIA,KAAK,CAACK,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAE;MAC1C;;MAEA;MACA,OAAOL,KAAK,GAAG,CAAC;IAClB,CAAC,EAAE;MAAEM,KAAK,EAAE,CAAC;MAAED,MAAM,EAAE;IAAM,CAAC,CAAC;;IAE/B;IACA,IAAIb,cAAc,KAAK,IAAI,EAAE;MAC3BA,cAAc,GAAGT,uBAAuB,CAACC,MAAM,EAAEC,WAAW,CAAC;MAC7D,IAAI,CAACO,cAAc,EAAE,OAAO,EAAE;IAChC;;IAEA;IACA,IAAID,IAAI,CAACnC,MAAM,GAAG,CAAC,IAAImC,IAAI,CAACA,IAAI,CAACnC,MAAM,GAAG,CAAC,CAAC,CAAC3C,YAAY,KAAKwE,WAAW,EAAE;MACzE,MAAM/B,aAAa,GAAGqC,IAAI,CAACQ,MAAM,CAAC,CAACQ,GAAG,EAAElF,OAAO,KAAKkF,GAAG,GAAGlF,OAAO,CAACmF,QAAQ,EAAE,CAAC,CAAC;MAC9E,IAAItD,aAAa,IAAIsC,cAAc,GAAG,CAAC,EAAE;QACvC,OAAO,CAACD,IAAI,CAAC;MACf;MACA,OAAO,EAAE;IACX;;IAEA;IACA,IAAIA,IAAI,CAACnC,MAAM,IAAIwB,WAAW,EAAE;MAC9B,OAAO,EAAE;IACX;;IAEA;IACA,MAAM6B,YAAY,GAAGlB,IAAI,CAACnC,MAAM,KAAK,CAAC,GAAG4B,MAAM,GAAGO,IAAI,CAACA,IAAI,CAACnC,MAAM,GAAG,CAAC,CAAC,CAAC3C,YAAY;IACpF,MAAMiG,cAAc,GAAGrH,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKgF,YAAY,CAAC;IAElE,IAAI,CAACC,cAAc,EAAE,OAAO,EAAE;;IAE9B;IACA,MAAMC,wBAAwB,GAAIC,WAAW,IAAK;MAChD,MAAMC,cAAc,GAAG,CAAC,CAAC;MACzBD,WAAW,CAACE,OAAO,CAACzF,OAAO,IAAI;QAC7B,MAAMxB,OAAO,GAAGR,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKJ,OAAO,CAACZ,YAAY,CAAC;QACnE,IAAI,CAACZ,OAAO,EAAE;QAEd,MAAMkH,OAAO,GAAGlH,OAAO,CAAC8B,OAAO;QAC/B,IAAI,CAACkF,cAAc,CAACE,OAAO,CAAC,EAAE;UAC5BF,cAAc,CAACE,OAAO,CAAC,GAAG;YAAEZ,WAAW,EAAE,CAAC;YAAEE,MAAM,EAAE;UAAM,CAAC;QAC7D;QAEA,IAAI7C,cAAc,CAAC3C,GAAG,CAACQ,OAAO,CAACZ,YAAY,CAAC,EAAE;UAC5CoG,cAAc,CAACE,OAAO,CAAC,CAACV,MAAM,GAAG,IAAI;QACvC,CAAC,MAAM;UACLQ,cAAc,CAACE,OAAO,CAAC,CAACZ,WAAW,IAAI,CAAC;QAC1C;MACF,CAAC,CAAC;MACF,OAAOU,cAAc;IACvB,CAAC;IAED,MAAMG,gBAAgB,GAAGvB,SAAS,CAACwB,MAAM,CAAC9F,KAAK,IAAI;MAAA,IAAA+F,cAAA,EAAAC,eAAA;MACjD,IAAIhG,KAAK,CAAC,gBAAgB,CAAC,KAAKsF,YAAY,EAAE,OAAO,KAAK;;MAE1D;MACA,MAAMvB,aAAa,GAAG7F,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKuD,MAAM,CAAC;MAC3D,MAAMG,WAAW,GAAG9F,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKwD,WAAW,CAAC;MAC9D,MAAMmC,kBAAkB,GAAG/H,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKN,KAAK,CAAC,cAAc,CAAC,CAAC;MAE/E,IAAI,CAAC+D,aAAa,IAAI,CAACC,WAAW,IAAI,CAACiC,kBAAkB,EAAE,OAAO,KAAK;;MAEvE;MACA,MAAMC,eAAe,GAAGV,wBAAwB,CAACpB,IAAI,CAAC;MACtD,MAAM+B,WAAW,GAAGF,kBAAkB,CAACzF,OAAO;;MAE9C;MACA,IAAI2F,WAAW,KAAKpC,aAAa,CAACvD,OAAO,IACrC2F,WAAW,KAAKnC,WAAW,CAACxD,OAAO,IACnC0F,eAAe,CAACC,WAAW,CAAC,IAAI,CAAC,IACjC,CAAC9D,cAAc,CAAC3C,GAAG,CAACM,KAAK,CAAC,cAAc,CAAC,CAAC,EAAE;QAC9C,OAAO,KAAK;MACd;;MAEA;MACA,MAAMoG,UAAU,IAAAL,cAAA,GAAG7H,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKuD,MAAM,CAAC,cAAAkC,cAAA,uBAArCA,cAAA,CAAuCM,IAAI;MAC9D,MAAMC,QAAQ,IAAAN,eAAA,GAAG9H,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKwD,WAAW,CAAC,cAAAkC,eAAA,uBAA1CA,eAAA,CAA4CK,IAAI;MACjE,MAAME,WAAW,GAAGN,kBAAkB,aAAlBA,kBAAkB,uBAAlBA,kBAAkB,CAAEI,IAAI;;MAE5C;MACA;MACA,IAAID,UAAU,KAAKE,QAAQ;MAAI;MAC3BC,WAAW,KAAKH,UAAU;MAAI;MAC9BG,WAAW,KAAKD,QAAQ,EAAE;QAAE;QAC9B,OAAO,KAAK;MACd;;MAEA;MACA,IAAI,CAACvH,sBAAsB,CAACiB,KAAK,EAAEoE,IAAI,CAAC,EAAE;QACxC,OAAO,KAAK;MACd;;MAEA;MACA,MAAM7D,cAAc,GAAGrC,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKN,KAAK,CAAC,cAAc,CAAC,CAAC;MAC3E,IAAI,CAACO,cAAc,EAAE,OAAO,KAAK;;MAEjC;MACA,MAAMiG,qBAAqB,GAAG,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC1H,QAAQ,CAACyB,cAAc,CAACC,OAAO,CAAC;MAC1F,IAAIgG,qBAAqB,IAAI,CAAC9B,kBAAkB,EAAE;QAChD,IAAI+B,eAAe,GAAG9B,oBAAoB,CAACK,WAAW;QACtD,IAAI0B,YAAY,GAAG/B,oBAAoB,CAACI,QAAQ;QAEhD,IAAI1C,cAAc,CAAC3C,GAAG,CAACM,KAAK,CAAC,cAAc,CAAC,CAAC,EAAE;UAC7C0G,YAAY,GAAG,CAAC;QAClB,CAAC,MAAM;UACLD,eAAe,IAAI,CAAC;QACtB;;QAEA;QACA,IAAIA,eAAe,GAAGC,YAAY,GAAG,CAAC,EAAE;UACtC,OAAO,KAAK;QACd;MACF;;MAEA;MACA,MAAMC,iBAAiB,GAAG9G,kBAAkB,CAACH,GAAG,CAACa,cAAc,CAACC,OAAO,CAAC;MACxE,MAAMoG,aAAa,GAAGvE,cAAc,CAAC3C,GAAG,CAACM,KAAK,CAAC,cAAc,CAAC,CAAC;MAE/D,IAAI2G,iBAAiB,EAAE;QACrB,IAAIE,eAAe,GAAG5B,gBAAgB;QACtC,IAAI2B,aAAa,IAAI,CAAC3B,gBAAgB,CAACC,MAAM,EAAE;UAC7C2B,eAAe,IAAI,CAAC,CAAC,CAAE;QACzB,CAAC,MAAM,IAAI,CAACD,aAAa,EAAE;UACzBC,eAAe,IAAI,CAAC,CAAC,CAAE;QACzB;QACA,IAAIA,eAAe,GAAG,CAAC,EAAE;UACvB,OAAO,KAAK;QACd;MACF;;MAEA;MACA,IAAI3C,OAAO,CAACxE,GAAG,CAACM,KAAK,CAAC,cAAc,CAAC,CAAC,EAAE,OAAO,KAAK;;MAEpD;MACA;MACA,MAAM8G,qBAAqB,GAAG3C,gBAAgB,CAACzE,GAAG,CAACa,cAAc,CAACC,OAAO,CAAC,IAC9CD,cAAc,CAACC,OAAO,KAAK+E,cAAc,CAAC/E,OAAO;MAC7E,IAAIsG,qBAAqB,EAAE,OAAO,KAAK;;MAEvC;MACA,MAAMC,aAAa,GAAGvB,wBAAwB,CAACpB,IAAI,CAAC;MACpD,MAAM4C,cAAc,GAAGzG,cAAc,CAACC,OAAO;MAC7C,IAAIwG,cAAc,KAAKjD,aAAa,CAACvD,OAAO,IACxCwG,cAAc,KAAKhD,WAAW,CAACxD,OAAO,IACtCuG,aAAa,CAACC,cAAc,CAAC,IAAI,CAAC,IAClC,CAAC3E,cAAc,CAAC3C,GAAG,CAACM,KAAK,CAAC,cAAc,CAAC,CAAC,EAAE;QAAE;QAChD,OAAO,KAAK;MACd;;MAEA;MACA,IAAI2G,iBAAiB,IACjB1B,gBAAgB,IAAI,CAAC,IACrB,CAAC5C,cAAc,CAAC3C,GAAG,CAACM,KAAK,CAAC,cAAc,CAAC,CAAC,EAAE;QAAE;QAChD,OAAO,KAAK;MACd;;MAEA;MACA,IAAImG,WAAW,KAAKpC,aAAa,CAACvD,OAAO,IAAI2F,WAAW,KAAKnC,WAAW,CAACxD,OAAO,EAAE;QAChF,MAAMyG,YAAY,GAAGf,eAAe,CAACC,WAAW,CAAC,IAAI;UAAEnB,WAAW,EAAE,CAAC;UAAEE,MAAM,EAAE;QAAM,CAAC;QACtF,IAAIgC,UAAU,GAAGD,YAAY,CAACjC,WAAW;QACzC,IAAIiC,YAAY,CAAC/B,MAAM,IAAI7C,cAAc,CAAC3C,GAAG,CAACM,KAAK,CAAC,cAAc,CAAC,CAAC,EAAE;UACpEkH,UAAU,IAAI,CAAC,CAAC,CAAC;QACnB;QACA,IAAIA,UAAU,IAAI,CAAC,EAAE;UACnB,OAAO,KAAK;QACd;MACF;MAEA,OAAO,IAAI;IACb,CAAC,CAAC;;IAEF;IACA,KAAK,MAAMhH,OAAO,IAAI2F,gBAAgB,EAAE;MACtC,MAAMtF,cAAc,GAAGrC,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKJ,OAAO,CAAC,cAAc,CAAC,CAAC;;MAE7E;MACA,MAAMiH,oBAAoB,GAAG/C,IAAI,CAACQ,MAAM,CAAC,CAACQ,GAAG,EAAEhG,GAAG,KAAKgG,GAAG,GAAGhG,GAAG,CAACiG,QAAQ,EAAE,CAAC,CAAC,GACpDnF,OAAO,CAAC,yBAAyB,CAAC;;MAE3D;MACA,IAAIiH,oBAAoB,GAAG9C,cAAc,GAAG,CAAC,EAAE;QAC7C;MACF;;MAEA;MACA,MAAM+C,UAAU,GAAG,IAAItH,GAAG,CAACoE,OAAO,CAAC;MACnCkD,UAAU,CAACC,GAAG,CAACnH,OAAO,CAAC,cAAc,CAAC,CAAC;MAEvC,MAAMoH,mBAAmB,GAAG,IAAIxH,GAAG,CAACqE,gBAAgB,CAAC;MACrDmD,mBAAmB,CAACD,GAAG,CAAC9G,cAAc,CAACC,OAAO,CAAC;MAE/C,MAAM+G,OAAO,GAAG,CAAC,GAAGnD,IAAI,EAAE;QACxB/E,cAAc,EAAEa,OAAO,CAAC,gBAAgB,CAAC;QACzCZ,YAAY,EAAEY,OAAO,CAAC,cAAc,CAAC;QACrCmF,QAAQ,EAAEnF,OAAO,CAAC,yBAAyB,CAAC;QAC5CM,OAAO,EAAED,cAAc,CAACC,OAAO,CAAC;MAClC,CAAC,CAAC;MAEF,MAAMgH,SAAS,GAAGvD,kBAAkB,CAClCJ,MAAM,EACNC,WAAW,EACXsD,UAAU,EACVE,mBAAmB,EACnBC,OAAO,EACPlD,cACF,CAAC;MAEDE,MAAM,CAACkD,IAAI,CAAC,GAAGD,SAAS,CAAC;IAC3B;IAEA,OAAOjD,MAAM;EACf,CAAC;;EAED;EACA;EACA,MAAMmD,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B;IACApE,YAAY,CAAC,IAAI,CAAC;IAClBH,cAAc,CAAC,KAAK,CAAC;IAErB,IAAI;MACF;MACA,MAAM,IAAIwE,OAAO,CAACC,OAAO,IAAIC,UAAU,CAACD,OAAO,EAAE,GAAG,CAAC,CAAC;MAEtD,IAAIzH,gBAAgB,IAAII,cAAc,EAAE;QACtC,MAAMuH,MAAM,GAAG,IAAIC,eAAe,CAAC,CAAC;QACpCD,MAAM,CAAClI,GAAG,CAAC,MAAM,EAAEO,gBAAgB,CAAC;QACpC2H,MAAM,CAAClI,GAAG,CAAC,IAAI,EAAEW,cAAc,CAAC;QAChCuH,MAAM,CAAClI,GAAG,CAAC,gBAAgB,EAAEK,cAAc,CAAC+H,IAAI,CAAC,GAAG,CAAC,CAAC;QAEtDC,MAAM,CAACC,OAAO,CAACC,SAAS,CACtB,CAAC,CAAC,EACF,EAAE,EACF,GAAGF,MAAM,CAACG,QAAQ,CAACC,QAAQ,IAAIP,MAAM,CAACQ,QAAQ,CAAC,CAAC,EAClD,CAAC;QAED,MAAMvE,aAAa,GAAG7F,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKH,gBAAgB,CAAC;QACrE,MAAM+D,OAAO,GAAG,IAAIpE,GAAG,CAAC,CAACK,gBAAgB,CAAC,CAAC;QAC3C,MAAMgE,gBAAgB,GAAG,IAAIrE,GAAG,CAAC,CAACiE,aAAa,CAACvD,OAAO,CAAC,CAAC;QAEzD,MAAM+D,MAAM,GAAGN,kBAAkB,CAC/B9D,gBAAgB,EAChBI,cAAc,EACd2D,OAAO,EACPC,gBACF,CAAC;;QAED;QACA,MAAMoE,cAAc,GAAGhE,MAAM,CAACuB,MAAM,CAAC9F,KAAK,IACxCD,wBAAwB,CAACC,KAAK,EAAEC,cAAc,CAChD,CAAC;;QAED;QACA,MAAMuI,YAAY,GAAGD,cAAc,CAAC3H,IAAI,CAAC,CAACP,CAAC,EAAEQ,CAAC,KAAK;UACjD,MAAM4H,SAAS,GAAG3G,sBAAsB,CAACzB,CAAC,CAAC;UAC3C,MAAMqI,SAAS,GAAG5G,sBAAsB,CAACjB,CAAC,CAAC;UAC3C,OAAO4H,SAAS,GAAGC,SAAS,CAAC,CAAC;QAChC,CAAC,CAAC;QAEFzF,gBAAgB,CAACuF,YAAY,CAAC;QAC9BrF,cAAc,CAAC,IAAI,CAAC;MACtB;IACF,CAAC,CAAC,OAAOwF,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IACjD,CAAC,SAAS;MACR;MACA,MAAM,IAAIhB,OAAO,CAACC,OAAO,IAAIC,UAAU,CAACD,OAAO,EAAE,GAAG,CAAC,CAAC;MACtDtE,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;;EAED;EACA,MAAMuF,iBAAiB,GAAIC,UAAU,IAAK;IACxC,IAAI,CAACA,UAAU,EAAE,OAAO,EAAE;IAE1B,MAAMC,KAAK,GAAGD,UAAU,CAACE,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;;IAE7C;IACA,MAAMC,gBAAgB,GAAGhL,QAAQ,CAAC4H,MAAM,CAACpH,OAAO,IAC9CA,OAAO,CAAC4B,IAAI,CAAC0I,WAAW,CAAC,CAAC,KAAKD,KACjC,CAAC;;IAED;IACA,MAAMI,mBAAmB,GAAGjL,QAAQ,CAAC4H,MAAM,CAACpH,OAAO,IACjDA,OAAO,CAAC4B,IAAI,CAAC0I,WAAW,CAAC,CAAC,CAACI,UAAU,CAACL,KAAK,CAAC,IAC5C,CAACG,gBAAgB,CAACpK,QAAQ,CAACJ,OAAO,CACpC,CAAC;;IAED;IACA,MAAM2K,mBAAmB,GAAGnL,QAAQ,CAAC4H,MAAM,CAACpH,OAAO,IACjDA,OAAO,CAAC4K,IAAI,CAACN,WAAW,CAAC,CAAC,CAACI,UAAU,CAACL,KAAK,CAAC,IAC5C,CAACG,gBAAgB,CAACpK,QAAQ,CAACJ,OAAO,CAAC,IACnC,CAACyK,mBAAmB,CAACrK,QAAQ,CAACJ,OAAO,CACvC,CAAC;;IAED;IACA,MAAM6K,qBAAqB,GAAGrL,QAAQ,CAAC4H,MAAM,CAACpH,OAAO,IACnDA,OAAO,CAAC4K,IAAI,CAACN,WAAW,CAAC,CAAC,CAAClK,QAAQ,CAACiK,KAAK,CAAC,IAC1C,CAACG,gBAAgB,CAACpK,QAAQ,CAACJ,OAAO,CAAC,IACnC,CAACyK,mBAAmB,CAACrK,QAAQ,CAACJ,OAAO,CAAC,IACtC,CAAC2K,mBAAmB,CAACvK,QAAQ,CAACJ,OAAO,CACvC,CAAC;;IAED;IACA,MAAM8K,UAAU,GAAG,CACjB,GAAGN,gBAAgB,EACnB,GAAGC,mBAAmB,EACtB,GAAGE,mBAAmB,EACtB,GAAGE,qBAAqB,CACzB,CAACE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAEf,OAAOD,UAAU,CAACrK,GAAG,CAACT,OAAO,KAAK;MAChCgC,KAAK,EAAEhC,OAAO,CAAC4B,IAAI;MACnBK,KAAK,EAAE,GAAGjC,OAAO,CAAC4B,IAAI,MAAM5B,OAAO,CAAC4K,IAAI,KAAK5K,OAAO,CAAC8B,OAAO;IAC9D,CAAC,CAAC,CAAC;EACL,CAAC;;EAED;EACA,MAAMkJ,iBAAiB,GAAIZ,UAAU,IAAK;IACxC,IAAI,CAACA,UAAU,EAAE,OAAO,EAAE;IAE1B,MAAMC,KAAK,GAAGD,UAAU,CAACE,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;IAC7C,MAAMU,SAAS,GAAGxL,kBAAkB,CAACD,QAAQ,CAAC;;IAE9C;IACA,MAAM0L,YAAY,GAAGD,SAAS,CAAC7D,MAAM,CAACF,OAAO,IAC3CA,OAAO,CAACoD,WAAW,CAAC,CAAC,KAAKD,KAC5B,CAAC;;IAED;IACA,MAAMc,eAAe,GAAGF,SAAS,CAAC7D,MAAM,CAACF,OAAO,IAC9CA,OAAO,CAACoD,WAAW,CAAC,CAAC,CAACI,UAAU,CAACL,KAAK,CAAC,IACvC,CAACa,YAAY,CAAC9K,QAAQ,CAAC8G,OAAO,CAChC,CAAC;;IAED;IACA,MAAMkE,kBAAkB,GAAGH,SAAS,CAAC7D,MAAM,CAACF,OAAO,IAAI;MACrD,IAAIgE,YAAY,CAAC9K,QAAQ,CAAC8G,OAAO,CAAC,IAAIiE,eAAe,CAAC/K,QAAQ,CAAC8G,OAAO,CAAC,EAAE;QACvE,OAAO,KAAK;MACd;MAEA,MAAMmE,YAAY,GAAGnE,OAAO,CAACoD,WAAW,CAAC,CAAC;MAC1C,IAAIgB,SAAS,GAAG,CAAC,CAAC;;MAElB;MACA,KAAK,MAAMC,IAAI,IAAIlB,KAAK,EAAE;QACxB,MAAMmB,KAAK,GAAGH,YAAY,CAACI,OAAO,CAACF,IAAI,EAAED,SAAS,GAAG,CAAC,CAAC;QACvD,IAAIE,KAAK,KAAK,CAAC,CAAC,EAAE,OAAO,KAAK;QAC9BF,SAAS,GAAGE,KAAK;MACnB;MAEA,OAAO,IAAI;IACb,CAAC,CAAC;;IAEF;IACA,MAAMV,UAAU,GAAG,CACjB,GAAGI,YAAY,EACf,GAAGC,eAAe,EAClB,GAAGC,kBAAkB,CACtB,CAACL,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAEf,OAAOD,UAAU,CAACrK,GAAG,CAACyG,OAAO,KAAK;MAChClF,KAAK,EAAEkF,OAAO;MACdjF,KAAK,EAAEiF;IACT,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAMwE,eAAe,GAAItB,UAAU,IAAK;IACtC,IAAI,CAACA,UAAU,EAAE,OAAO,EAAE;IAE1B,MAAMC,KAAK,GAAGD,UAAU,CAACE,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;IAC7C,MAAMU,SAAS,GAAGxL,kBAAkB,CAACD,QAAQ,CAAC;;IAE9C;IACA,MAAM0L,YAAY,GAAGD,SAAS,CAAC7D,MAAM,CAACF,OAAO,IAC3CA,OAAO,CAACoD,WAAW,CAAC,CAAC,KAAKD,KAC5B,CAAC;;IAED;IACA,MAAMc,eAAe,GAAGF,SAAS,CAAC7D,MAAM,CAACF,OAAO,IAC9CA,OAAO,CAACoD,WAAW,CAAC,CAAC,CAACI,UAAU,CAACL,KAAK,CAAC,IACvC,CAACa,YAAY,CAAC9K,QAAQ,CAAC8G,OAAO,CAChC,CAAC;;IAED;IACA,MAAMyE,iBAAiB,GAAGV,SAAS,CAAC7D,MAAM,CAACF,OAAO,IAChDA,OAAO,CAACoD,WAAW,CAAC,CAAC,CAAClK,QAAQ,CAACiK,KAAK,CAAC,IACrC,CAACa,YAAY,CAAC9K,QAAQ,CAAC8G,OAAO,CAAC,IAC/B,CAACiE,eAAe,CAAC/K,QAAQ,CAAC8G,OAAO,CACnC,CAAC;IAED,OAAO,CAAC,GAAGgE,YAAY,EAAE,GAAGC,eAAe,EAAE,GAAGQ,iBAAiB,CAAC,CAC/DZ,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CACXtK,GAAG,CAACyG,OAAO,KAAK;MACflF,KAAK,EAAEkF,OAAO;MACdjF,KAAK,EAAEiF;IACT,CAAC,CAAC,CAAC;EACP,CAAC;EAED,MAAM0E,kBAAkB,GAAIxB,UAAU,IACpC,IAAInB,OAAO,CAAEC,OAAO,IAAK;IACvBA,OAAO,CAACwC,eAAe,CAACtB,UAAU,CAAC,CAAC;EACtC,CAAC,CAAC;EAEJ,MAAMyB,cAAc,GAAIzB,UAAU,IAAK;IACrC,IAAI,CAACA,UAAU,EAAE,OAAO,EAAE;IAE1B,MAAMC,KAAK,GAAGD,UAAU,CAACE,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;;IAE7C;IACA,MAAMuB,iBAAiB,GAAGtM,QAAQ,CAAC4H,MAAM,CAACpH,OAAO,IAC/C,CAACuB,cAAc,CAACnB,QAAQ,CAACJ,OAAO,CAAC8B,OAAO,CAC1C,CAAC;;IAED;IACA,MAAM0I,gBAAgB,GAAGsB,iBAAiB,CAAC1E,MAAM,CAACpH,OAAO,IACvDA,OAAO,CAAC4B,IAAI,CAAC0I,WAAW,CAAC,CAAC,KAAKD,KACjC,CAAC;;IAED;IACA,MAAMI,mBAAmB,GAAGqB,iBAAiB,CAAC1E,MAAM,CAACpH,OAAO,IAC1DA,OAAO,CAAC4B,IAAI,CAAC0I,WAAW,CAAC,CAAC,CAACI,UAAU,CAACL,KAAK,CAAC,IAC5C,CAACG,gBAAgB,CAACpK,QAAQ,CAACJ,OAAO,CACpC,CAAC;;IAED;IACA,MAAM2K,mBAAmB,GAAGmB,iBAAiB,CAAC1E,MAAM,CAACpH,OAAO,IAC1DA,OAAO,CAAC4K,IAAI,CAACN,WAAW,CAAC,CAAC,CAACI,UAAU,CAACL,KAAK,CAAC,IAC5C,CAACG,gBAAgB,CAACpK,QAAQ,CAACJ,OAAO,CAAC,IACnC,CAACyK,mBAAmB,CAACrK,QAAQ,CAACJ,OAAO,CACvC,CAAC;;IAED;IACA,MAAM6K,qBAAqB,GAAGiB,iBAAiB,CAAC1E,MAAM,CAACpH,OAAO,IAC5DA,OAAO,CAAC4K,IAAI,CAACN,WAAW,CAAC,CAAC,CAAClK,QAAQ,CAACiK,KAAK,CAAC,IAC1C,CAACG,gBAAgB,CAACpK,QAAQ,CAACJ,OAAO,CAAC,IACnC,CAACyK,mBAAmB,CAACrK,QAAQ,CAACJ,OAAO,CAAC,IACtC,CAAC2K,mBAAmB,CAACvK,QAAQ,CAACJ,OAAO,CACvC,CAAC;;IAED;IACA,MAAM8K,UAAU,GAAG,CACjB,GAAGN,gBAAgB,EACnB,GAAGC,mBAAmB,EACtB,GAAGE,mBAAmB,EACtB,GAAGE,qBAAqB,CACzB,CAACE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAEf,OAAOD,UAAU,CAACrK,GAAG,CAACT,OAAO,KAAK;MAChCgC,KAAK,EAAEhC,OAAO,CAAC4B,IAAI;MACnBK,KAAK,EAAE,GAAGjC,OAAO,CAAC4B,IAAI,MAAM5B,OAAO,CAAC4K,IAAI,KAAK5K,OAAO,CAAC8B,OAAO;IAC9D,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAMiK,kBAAkB,GAAI3B,UAAU,IACpC,IAAInB,OAAO,CAAEC,OAAO,IAAK;IACvBA,OAAO,CAAC2C,cAAc,CAACzB,UAAU,CAAC,CAAC;EACrC,CAAC,CAAC;;EAEJ;EACA,MAAM4B,cAAc,GAAI5B,UAAU,IAAK;IACrC,IAAI,CAACA,UAAU,EAAE,OAAOrI,QAAQ;IAEhC,MAAMsI,KAAK,GAAGD,UAAU,CAACE,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;;IAE7C;IACA,MAAM0B,gBAAgB,GAAGlK,QAAQ,CAACqF,MAAM,CAAC8E,OAAO,IAC9CA,OAAO,CAAClK,KAAK,CAACsI,WAAW,CAAC,CAAC,KAAKD,KAClC,CAAC;;IAED;IACA,MAAM8B,mBAAmB,GAAGpK,QAAQ,CAACqF,MAAM,CAAC8E,OAAO,IACjDA,OAAO,CAAClK,KAAK,CAACsI,WAAW,CAAC,CAAC,CAACI,UAAU,CAACL,KAAK,CAAC,IAC7C,CAAC4B,gBAAgB,CAAC7L,QAAQ,CAAC8L,OAAO,CACpC,CAAC;;IAED;IACA,MAAME,WAAW,GAAGrK,QAAQ,CAACqF,MAAM,CAAC8E,OAAO,IACzCA,OAAO,CAACjK,KAAK,CAACqI,WAAW,CAAC,CAAC,CAAClK,QAAQ,CAACiK,KAAK,CAAC,IAC3C,CAAC4B,gBAAgB,CAAC7L,QAAQ,CAAC8L,OAAO,CAAC,IACnC,CAACC,mBAAmB,CAAC/L,QAAQ,CAAC8L,OAAO,CACvC,CAAC;IAED,OAAO,CAAC,GAAGD,gBAAgB,EAAE,GAAGE,mBAAmB,EAAE,GAAGC,WAAW,CAAC;EACtE,CAAC;EAED,MAAMC,kBAAkB,GAAIjC,UAAU,IACpC,IAAInB,OAAO,CAAEC,OAAO,IAAK;IACvBA,OAAO,CAAC8C,cAAc,CAAC5B,UAAU,CAAC,CAAC;EACrC,CAAC,CAAC;;EAEJ;EACAnM,SAAS,CAAC,MAAM;IACd,IAAIwD,gBAAgB,EAAE;MAAA,IAAA6K,eAAA;MACpB,MAAMC,gBAAgB,IAAAD,eAAA,GAAG9M,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKH,gBAAgB,CAAC,cAAA6K,eAAA,uBAA/CA,eAAA,CAAiDxK,OAAO;MACjF,IAAIyK,gBAAgB,IAAIhL,cAAc,CAACnB,QAAQ,CAACmM,gBAAgB,CAAC,EAAE;QACjEnI,mBAAmB,CAAC,EAAE,CAAC;MACzB;IACF;IAEA,IAAIvC,cAAc,EAAE;MAAA,IAAA2K,eAAA;MAClB,MAAMlE,cAAc,IAAAkE,eAAA,GAAGhN,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKC,cAAc,CAAC,cAAA2K,eAAA,uBAA7CA,eAAA,CAA+C1K,OAAO;MAC7E,IAAIwG,cAAc,IAAI/G,cAAc,CAACnB,QAAQ,CAACkI,cAAc,CAAC,EAAE;QAC7DjE,iBAAiB,CAAC,EAAE,CAAC;MACvB;IACF;EACF,CAAC,EAAE,CAAC9C,cAAc,EAAEE,gBAAgB,EAAEI,cAAc,CAAC,CAAC;;EAEtD;EACA5D,SAAS,CAAC,MAAM;IACd,MAAMmL,MAAM,GAAG,IAAIC,eAAe,CAAC,CAAC;IACpC,IAAI5H,gBAAgB,EAAE2H,MAAM,CAAClI,GAAG,CAAC,MAAM,EAAEO,gBAAgB,CAAC;IAC1D,IAAII,cAAc,EAAEuH,MAAM,CAAClI,GAAG,CAAC,IAAI,EAAEW,cAAc,CAAC;IACpD,IAAIN,cAAc,CAACgC,MAAM,GAAG,CAAC,EAAE6F,MAAM,CAAClI,GAAG,CAAC,OAAO,EAAEK,cAAc,CAAC+H,IAAI,CAAC,GAAG,CAAC,CAAC;IAC5E,IAAIvE,WAAW,KAAK,CAAC,EAAEqE,MAAM,CAAClI,GAAG,CAAC,KAAK,EAAE6D,WAAW,CAAC6E,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;;IAElE,MAAM6C,MAAM,GAAG,GAAGlD,MAAM,CAACG,QAAQ,CAACC,QAAQ,GAAGP,MAAM,CAACQ,QAAQ,CAAC,CAAC,GAAG,GAAG,GAAGR,MAAM,CAACQ,QAAQ,CAAC,CAAC,GAAG,EAAE,EAAE;IAC/FL,MAAM,CAACC,OAAO,CAACkD,YAAY,CAAC,CAAC,CAAC,EAAE,EAAE,EAAED,MAAM,CAAC;EAC7C,CAAC,EAAE,CAAChL,gBAAgB,EAAEI,cAAc,EAAEN,cAAc,EAAEwD,WAAW,CAAC,CAAC;;EAEnE;EACA9G,SAAS,CAAC,MAAM;IACd,MAAMmL,MAAM,GAAG,IAAIC,eAAe,CAACE,MAAM,CAACG,QAAQ,CAACiD,MAAM,CAAC;IAC1D,MAAMC,WAAW,GAAGxD,MAAM,CAACnI,GAAG,CAAC,MAAM,CAAC;IACtC,MAAM4L,SAAS,GAAGzD,MAAM,CAACnI,GAAG,CAAC,IAAI,CAAC;IAClC,MAAM6L,UAAU,GAAG1D,MAAM,CAACnI,GAAG,CAAC,OAAO,CAAC;IACtC,MAAM8L,QAAQ,GAAG3D,MAAM,CAACnI,GAAG,CAAC,KAAK,CAAC;IAElC,IAAI2L,WAAW,EAAExI,mBAAmB,CAACwI,WAAW,CAAC;IACjD,IAAIC,SAAS,EAAExI,iBAAiB,CAACwI,SAAS,CAAC;IAC3C,IAAIC,UAAU,EAAEpI,iBAAiB,CAACoI,UAAU,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC;IACxD,IAAID,QAAQ,EAAE;MACZ,MAAME,QAAQ,GAAGC,QAAQ,CAACH,QAAQ,EAAE,EAAE,CAAC;MACvC,IAAI,CAACI,KAAK,CAACF,QAAQ,CAAC,IAAIA,QAAQ,IAAI,CAAC,IAAIA,QAAQ,IAAI,CAAC,EAAE;QACtDjI,cAAc,CAACiI,QAAQ,CAAC;MAC1B;IACF;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,oBACEpN,OAAA;IAAKuN,SAAS,EAAC,kBAAkB;IAAAC,QAAA,gBAC/BxN,OAAA;MAAKuN,SAAS,EAAC,cAAc;MAAAC,QAAA,gBAC3BxN,OAAA;QAAKuN,SAAS,EAAC,gBAAgB;QAAAC,QAAA,gBAC7BxN,OAAA;UAAKuN,SAAS,EAAC,sCAAsC;UAAAC,QAAA,gBACnDxN,OAAA;YAAOyN,KAAK,EAAE;cAAEC,UAAU,EAAE;YAAI,CAAE;YAAAF,QAAA,EAAC;UAAkB;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC7D9N,OAAA,CAACF,WAAW;YACVyN,SAAS,EAAC,cAAc;YACxBQ,YAAY;YACZC,cAAc;YACd7L,KAAK,EAAEP,gBAAgB,GAAG;cACxBO,KAAK,EAAEP,gBAAgB;cACvBQ,KAAK,EAAE,EAAA6B,eAAA,GAAAtE,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKH,gBAAgB,CAAC,cAAAqC,eAAA,uBAA/CA,eAAA,CAAiDlC,IAAI,IAC1D,KAAK,KAAAmC,eAAA,GAAGvE,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKH,gBAAgB,CAAC,cAAAsC,eAAA,uBAA/CA,eAAA,CAAiD6G,IAAI,IAC7D,IAAI,KAAA5G,eAAA,GAAGxE,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKH,gBAAgB,CAAC,cAAAuC,eAAA,uBAA/CA,eAAA,CAAiDlC,OAAO,IAAG;YACtE,CAAC,GAAG,IAAK;YACTgM,WAAW,EAAE/B,kBAAmB;YAChCgC,QAAQ,EAAGC,QAAQ,IAAK5J,mBAAmB,CAAC4J,QAAQ,GAAGA,QAAQ,CAAChM,KAAK,GAAG,EAAE,CAAE;YAC5EiM,UAAU,EAAEtJ,SAAU;YACtBuJ,WAAW,EAAC;UAAoB;YAAAV,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACjC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eACN9N,OAAA;UAAKuN,SAAS,EAAC,oCAAoC;UAAAC,QAAA,gBACjDxN,OAAA;YAAOyN,KAAK,EAAE;cAAEC,UAAU,EAAE;YAAI,CAAE;YAAAF,QAAA,EAAC;UAAgB;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC3D9N,OAAA,CAACF,WAAW;YACVyN,SAAS,EAAC,cAAc;YACxBQ,YAAY;YACZC,cAAc;YACd7L,KAAK,EAAEH,cAAc,GAAG;cACtBG,KAAK,EAAEH,cAAc;cACrBI,KAAK,EAAE,EAAAgC,eAAA,GAAAzE,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKC,cAAc,CAAC,cAAAoC,eAAA,uBAA7CA,eAAA,CAA+CrC,IAAI,IACxD,KAAK,KAAAsC,eAAA,GAAG1E,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKC,cAAc,CAAC,cAAAqC,eAAA,uBAA7CA,eAAA,CAA+C0G,IAAI,IAC3D,IAAI,KAAAzG,gBAAA,GAAG3E,QAAQ,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKC,cAAc,CAAC,cAAAsC,gBAAA,uBAA7CA,gBAAA,CAA+CrC,OAAO,IAAG;YACpE,CAAC,GAAG,IAAK;YACTgM,WAAW,EAAE/B,kBAAmB;YAChCgC,QAAQ,EAAGC,QAAQ,IAAK3J,iBAAiB,CAAC2J,QAAQ,GAAGA,QAAQ,CAAChM,KAAK,GAAG,EAAE,CAAE;YAC1EiM,UAAU,EAAEtJ,SAAU;YACtBuJ,WAAW,EAAC;UAAoB;YAAAV,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACjC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eACN9N,OAAA;QAAKuN,SAAS,EAAC,kBAAkB;QAAAC,QAAA,gBAC/BxN,OAAA;UAAAwN,QAAA,EAAO;QAAgB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAC/B9N,OAAA,CAACF,WAAW;UACVwO,OAAO;UACPf,SAAS,EAAC,qCAAqC;UAC/CQ,YAAY;UACZC,cAAc;UACd7L,KAAK,EAAET,cAAc,CAACd,GAAG,CAACyG,OAAO,KAAK;YACpClF,KAAK,EAAEkF,OAAO;YACdjF,KAAK,EAAEiF;UACT,CAAC,CAAC,CAAE;UACJ4G,WAAW,EAAElC,kBAAmB;UAChCmC,QAAQ,EAAGC,QAAQ,IAAK;YACtBtJ,iBAAiB,CAACsJ,QAAQ,GAAGA,QAAQ,CAACvN,GAAG,CAAC2N,MAAM,IAAIA,MAAM,CAACpM,KAAK,CAAC,GAAG,EAAE,CAAC;UACzE,CAAE;UACFiM,UAAU,EAAEtJ,SAAU;UACtBuJ,WAAW,EAAC;QAAqB;UAAAV,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eACN9N,OAAA;QAAKuN,SAAS,EAAC,kBAAkB;QAAAC,QAAA,gBAC/BxN,OAAA;UAAAwN,QAAA,EAAO;QAAe;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAC9B9N,OAAA,CAACF,WAAW;UACVwO,OAAO;UACPf,SAAS,EAAC,oCAAoC;UAC9CQ,YAAY;UACZC,cAAc,EAAE9L,QAAS;UACzBC,KAAK,EAAE6C,aAAa,CAACpE,GAAG,CAACyL,OAAO;YAAA,IAAAmC,cAAA;YAAA,OAAK;cACnCrM,KAAK,EAAEkK,OAAO;cACdjK,KAAK,EAAE,EAAAoM,cAAA,GAAAtM,QAAQ,CAACL,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACK,KAAK,KAAKkK,OAAO,CAAC,cAAAmC,cAAA,uBAAvCA,cAAA,CAAyCpM,KAAK,KAAIiK;YAC3D,CAAC;UAAA,CAAC,CAAE;UACJ4B,WAAW,EAAEzB,kBAAmB;UAChC0B,QAAQ,EAAGC,QAAQ,IAAK;YACtBlJ,gBAAgB,CAACkJ,QAAQ,GAAGA,QAAQ,CAACvN,GAAG,CAAC2N,MAAM,IAAIA,MAAM,CAACpM,KAAK,CAAC,GAAG,EAAE,CAAC;UACxE,CAAE;UACFiM,UAAU,EAAEtJ,SAAU;UACtBuJ,WAAW,EAAC;QAA6B;UAAAV,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC1C,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eACN9N,OAAA;QAAKuN,SAAS,EAAC,yCAAyC;QAAAC,QAAA,gBACtDxN,OAAA;UAAAwN,QAAA,EAAO;QAAgB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAC/B9N,OAAA;UACEyO,IAAI,EAAC,QAAQ;UACbC,GAAG,EAAC,GAAG;UACPC,GAAG,EAAC,GAAG;UACPxM,KAAK,EAAE+C,WAAY;UACnBgJ,QAAQ,EAAGU,CAAC,IAAK;YACf,MAAMzM,KAAK,GAAGkL,QAAQ,CAACuB,CAAC,CAACC,MAAM,CAAC1M,KAAK,EAAE,EAAE,CAAC;YAC1C,IAAI,CAACmL,KAAK,CAACnL,KAAK,CAAC,IAAIA,KAAK,IAAI,CAAC,IAAIA,KAAK,IAAI,CAAC,EAAE;cAC7CgD,cAAc,CAAChD,KAAK,CAAC;YACvB;UACF;QAAE;UAAAwL,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eACN9N,OAAA;QACEuN,SAAS,EAAC,eAAe;QACzBuB,OAAO,EAAE3F,YAAa;QACtB4F,QAAQ,EAAEjK,SAAS,IAAI,CAAClD,gBAAgB,IAAI,CAACI,cAAe;QAAAwL,QAAA,EAE3D1I,SAAS,GAAG,cAAc,GAAG;MAAQ;QAAA6I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAChC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC,eACN9N,OAAA,CAAC1B,aAAa;MACZ0Q,OAAO,EAAEvK,aAAc;MACvBwK,SAAS,EAAEtK;IAAY;MAAAgJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACxB,CAAC,EAEDhJ,SAAS,iBACR9E,OAAA;MAAKuN,SAAS,EAAC,iBAAiB;MAAAC,QAAA,gBAC9BxN,OAAA;QAAKuN,SAAS,EAAC;MAAiB;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eACvC9N,OAAA;QAAKuN,SAAS,EAAC,cAAc;QAAAC,QAAA,EAAC;MAAuB;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACxD,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;AAAC9J,EAAA,CApvBeD,UAAU;AAAAmL,EAAA,GAAVnL,UAAU;AAAA,IAAAmL,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}